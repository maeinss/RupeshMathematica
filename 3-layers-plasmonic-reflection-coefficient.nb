(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    185490,       3913]
NotebookOptionsPosition[    180654,       3834]
NotebookOutlinePosition[    181052,       3850]
CellTagsIndexPosition[    181009,       3847]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7855067698475027`*^9, 3.7855068571920433`*^9}, {
   3.785510038647949*^9, 3.785510052313773*^9}, 3.785510523069849*^9, {
   3.7855106077701826`*^9, 3.7855106078778915`*^9}, {3.785512337144236*^9, 
   3.785512401044236*^9}, {3.7855129114139147`*^9, 3.785512915176815*^9}, {
   3.7855180771060033`*^9, 3.7855180775667715`*^9}, {3.7855181148529625`*^9, 
   3.785518150818573*^9}, {3.7855185965082984`*^9, 3.785518613362252*^9}, {
   3.7855187173393183`*^9, 3.78551878256462*^9}, {3.785519006183885*^9, 
   3.785519031660817*^9}, {3.785519204322954*^9, 3.7855193017007556`*^9}, {
   3.785519333399299*^9, 3.7855194617217937`*^9}, {3.7855195212938614`*^9, 
   3.7855195279854045`*^9}, {3.7855212112781076`*^9, 
   3.7855212187675776`*^9}, {3.785521416487167*^9, 3.785521417052539*^9}, 
   3.7855215541871133`*^9},ExpressionUUID->"c634ed1a-5c65-414f-ad47-\
58390a39359b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Layers", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{
  3.7893080152086473`*^9, 3.789308497929611*^9, 3.7893089844574103`*^9, 
   3.7893102293030553`*^9, 3.789310678406498*^9, {3.7893108760813093`*^9, 
   3.789310895474047*^9}, 3.789498914311472*^9, 
   3.789498947253589*^9},ExpressionUUID->"971af514-a3c5-4aa3-9920-\
53ece1d152e2"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"hbar", "=", 
    RowBox[{"1.0545717", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "27"}]]}]}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"clight", "=", "29979245800."}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"e", "=", 
    RowBox[{"4.80320425", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}]}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"eV", "=", 
    RowBox[{"e", " ", 
     FractionBox["1.", "300."]}]}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nm", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7893202509474735`*^9, 3.789320253303204*^9}, 
   3.7894793259525905`*^9, {3.7894793601511736`*^9, 3.789479373113525*^9}, {
   3.7896778414220953`*^9, 3.789677841834751*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"ff166fa1-dbce-45c2-a190-d0e3d516f3aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Orange", ",", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".5"}], ",", "0"}], "}"}], ",", "2.5", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Thick", ",", "Green", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", ".3"}], "}"}]}], "]"}], ","}], "*)"}], "Thick", 
     ",", "Cyan", ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", ".3"}], "}"}]}], "]"}], ",", "Thick", ",", "Red", 
     ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", ".5"}], "}"}]}], "]"}], ",", "Orange", ",", "Black",
      ",", "Dashed", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", ".5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", ".5"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", "\"\<\[Epsilon]m\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", ".25"}], "}"}]}], "]"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", "\"\<\[Epsilon]1\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".5"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", "\"\<\[Epsilon]3\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".5"}], ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", "\"\<z=-d\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", 
          RowBox[{"-", ".2"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", "\"\<z=0\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", ".7"}], "}"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Black"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7894801090177765`*^9, 3.789480125830837*^9}, {
  3.789480158042726*^9, 3.7894802832667065`*^9}, {3.7894803331264286`*^9, 
  3.78948050731155*^9}, {3.7894806286468563`*^9, 3.7894806290667615`*^9}, {
  3.7894807018202763`*^9, 3.789480732384093*^9}, {3.789480795069541*^9, 
  3.7894808024608*^9}, {3.7894809637339892`*^9, 3.789481412160551*^9}, {
  3.7894820057713113`*^9, 3.7894820068335123`*^9}, {3.7894820452128935`*^9, 
  3.7894821917889595`*^9}, {3.7894822298133154`*^9, 3.789482489905508*^9}, {
  3.7894825311697235`*^9, 3.78948265185065*^9}, {3.7894827905609136`*^9, 
  3.7894828181731043`*^9}, {3.789482854506982*^9, 3.789482937177146*^9}, {
  3.7897612863537292`*^9, 
  3.789761292329392*^9}},ExpressionUUID->"c655446d-0767-4591-9960-\
ff6a954f7afd"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[1, 0.5, 0], 
    DiskBox[{-0.5, 0}, 2.5, 
     NCache[{-Pi, Pi}, {-3.141592653589793, 3.141592653589793}]]}, 
   {RGBColor[0, 1, 1], Thickness[Large], RectangleBox[{-3, 2.5}, {2, 0.3}]}, 
   {RGBColor[1, 0, 0], Thickness[Large], RectangleBox[{-3, 0}, {2, 0.5}], 
    {GrayLevel[0], Dashing[{Small, Small}], LineBox[{{-1, 0}, {4, 0}}], 
     LineBox[{{-1, 0.5}, {4, 0.5}}]}}},
  BaseStyle->{FontFamily -> "Helvetica", FontSize -> 16, 
    GrayLevel[0]},
  Epilog->{
    InsetBox[
     FormBox[
      StyleBox["\"\[Epsilon]m\"", StripOnInput -> False], 
      TraditionalForm], {-0.5, 0.25}], 
    InsetBox[
     FormBox[
      StyleBox["\"\[Epsilon]1\"", StripOnInput -> False], 
      TraditionalForm], {-0.5, -1}], 
    InsetBox[
     FormBox[
      StyleBox["\"\[Epsilon]3\"", StripOnInput -> False], 
      TraditionalForm], {-0.5, 1}], 
    InsetBox[
     FormBox[
      StyleBox["\"z=-d\"", StripOnInput -> False], TraditionalForm], {
     3, -0.2}], 
    InsetBox[
     FormBox[
      StyleBox["\"z=0\"", StripOnInput -> False], TraditionalForm], {
     3, 0.7}]}]], "Output",
 CellChangeTimes->{
  3.7894821009334126`*^9, {3.789482152540874*^9, 3.789482192514021*^9}, {
   3.789482233908369*^9, 3.789482490479972*^9}, {3.7894825317771387`*^9, 
   3.7894825922534432`*^9}, {3.78948263258113*^9, 3.789482672781699*^9}, {
   3.789482802480054*^9, 3.7894828188792157`*^9}, {3.7894828581654015`*^9, 
   3.78948293768379*^9}, 3.78948298227672*^9, 3.7894832276270227`*^9, 
   3.789483410484091*^9, {3.789483460812882*^9, 3.7894835012427797`*^9}, 
   3.789484012567274*^9, 3.7894840844820375`*^9, 3.7894841596357765`*^9, 
   3.789484575134444*^9, 3.789485037492123*^9, 3.789485103528571*^9, 
   3.789485158801381*^9, 3.7894852020587497`*^9, 3.7894852751201935`*^9, 
   3.7894853107688985`*^9, 3.789485470691461*^9, 3.7894855362631655`*^9, {
   3.789485585121532*^9, 3.7894856085708494`*^9}, 3.789488360560873*^9, 
   3.7894904595870066`*^9, 3.789490525963574*^9, 3.789490625494171*^9, 
   3.789490671078679*^9, 3.789492233861788*^9, 3.789492352191515*^9, 
   3.7894931706573877`*^9, {3.789493377784125*^9, 3.7894933972530513`*^9}, 
   3.789493495645465*^9, 3.789493912406863*^9, {3.789494102442272*^9, 
   3.78949412694976*^9}, {3.789494195297959*^9, 3.789494218832049*^9}, {
   3.789494274724222*^9, 3.7894942994697556`*^9}, {3.7894944067862678`*^9, 
   3.7894944753769226`*^9}, {3.7894945186703978`*^9, 
   3.7894946099673815`*^9}, {3.789494677234165*^9, 3.7894947121847196`*^9}, {
   3.7894952093571415`*^9, 3.789495225045138*^9}, 3.7894952700697813`*^9, 
   3.789496578657816*^9, {3.7894966209699554`*^9, 3.7894966489322524`*^9}, {
   3.7894967823255577`*^9, 3.789496816390652*^9}, 3.7894968728649635`*^9, 
   3.7894969697667007`*^9, 3.7894971529250293`*^9, {3.7894971869171658`*^9, 
   3.7894972074514694`*^9}, {3.7894972520632315`*^9, 3.7894972819563246`*^9}, 
   3.789497430136055*^9, {3.78949763905451*^9, 3.789497656488905*^9}, 
   3.7894977321735888`*^9, 3.789497801400739*^9, {3.7894978878041687`*^9, 
   3.7894979229162884`*^9}, 3.7894980601789713`*^9, {3.789498106667272*^9, 
   3.789498130268183*^9}, 3.789498183597681*^9, 3.789498299949815*^9, 
   3.7894983591661654`*^9, 3.789498407859976*^9, 3.7894984543976326`*^9, 
   3.7894985139266524`*^9, 3.7894985543984585`*^9, {3.7894986240868526`*^9, 
   3.7894986362533*^9}, 3.789498707433014*^9, {3.7894988170315075`*^9, 
   3.789498879138487*^9}, {3.7894989154863253`*^9, 3.7894989486149817`*^9}, 
   3.7894995952111425`*^9, 3.7894996511346793`*^9, {3.789500036853959*^9, 
   3.7895000615170317`*^9}, {3.7895001314261255`*^9, 3.789500150110282*^9}, 
   3.7895002465734634`*^9, 3.7895004161597013`*^9, 3.7895004704535656`*^9, 
   3.789500563805435*^9, 3.7895006857248755`*^9, 3.789500800863197*^9, {
   3.789500843208997*^9, 3.7895008550693216`*^9}, {3.7895008962981305`*^9, 
   3.78950090569411*^9}, 3.789500989385478*^9, 3.789501075059957*^9, 
   3.7895013859381847`*^9, 3.789501542861123*^9, 3.7895015866137323`*^9, 
   3.7895016916781025`*^9, 3.789501975891876*^9, 3.7895020811883516`*^9, {
   3.789502136514825*^9, 3.7895021594465256`*^9}, 3.789502250086292*^9, 
   3.789502334235159*^9, 3.789502385628646*^9, {3.7895024378975086`*^9, 
   3.7895024524466186`*^9}, {3.789502498091571*^9, 3.789502505408143*^9}, 
   3.7895025517184973`*^9, 3.789565457430685*^9, 3.7895655780356793`*^9, 
   3.789565619365331*^9, 3.7895656949913692`*^9, 3.7895657642083426`*^9, 
   3.789565794907699*^9, 3.7895662952702413`*^9, {3.7895663319237328`*^9, 
   3.7895663544157047`*^9}, 3.789566439803854*^9, {3.789566885704457*^9, 
   3.789566905126539*^9}, 3.789567027054059*^9, 3.7895670723549337`*^9, 
   3.789567156312042*^9, 3.7895675340836267`*^9, {3.7895677446590576`*^9, 
   3.7895677904865537`*^9}, 3.789569078266651*^9, {3.789569108804109*^9, 
   3.7895691149272175`*^9}, {3.789569328462805*^9, 3.789569346879553*^9}, 
   3.789569408158553*^9, 3.789569516284746*^9, 3.789569667606873*^9, 
   3.7895697490057964`*^9, 3.7895700932874856`*^9, 3.7895702134038577`*^9, {
   3.7895703826065135`*^9, 3.7895704561764936`*^9}, 3.7895705058629055`*^9, 
   3.789570586037654*^9, 3.7895707807444935`*^9, 3.7895709153554897`*^9, 
   3.789570952496356*^9, 3.789571023310028*^9, 3.789571093157468*^9, 
   3.7895716279184227`*^9, 3.7895718444303823`*^9, 3.78957194881706*^9, 
   3.7895720405970945`*^9, 3.789572080193921*^9, 3.7895722210631814`*^9, {
   3.789572259559587*^9, 3.7895722736106215`*^9}, {3.789572307493022*^9, 
   3.7895723547516923`*^9}, 3.789572397482295*^9, {3.789572448250903*^9, 
   3.789572495033016*^9}, 3.7895739751184053`*^9, {3.7895852238010736`*^9, 
   3.789585258205358*^9}, 3.7895855388479304`*^9, {3.7895856368963723`*^9, 
   3.7895856528237963`*^9}, 3.789585693532298*^9, 3.789585727078625*^9, {
   3.7895862845864735`*^9, 3.789586301490259*^9}, {3.7895863413918176`*^9, 
   3.78958636558515*^9}, 3.789586400355203*^9, {3.7895864586524806`*^9, 
   3.789586487556241*^9}, 3.7895865323724155`*^9, 3.789587857799858*^9, 
   3.789587976951124*^9, 3.7895880218831816`*^9, 3.789588278216159*^9, 
   3.789588909620867*^9, 3.789659148814599*^9, 3.7896749855881124`*^9, 
   3.789676125577442*^9, {3.78967627098007*^9, 3.7896762995840235`*^9}, 
   3.789676928716036*^9, 3.7896775691859202`*^9, {3.789677754920843*^9, 
   3.789677782047138*^9}, 3.789678143297882*^9, 3.7896784348885584`*^9, 
   3.789678528605591*^9, {3.7896786859027157`*^9, 3.789678713997141*^9}, 
   3.7896787611147313`*^9, 3.7896788235826473`*^9, 3.789678989860408*^9, 
   3.7896796590708003`*^9, 3.789679752846371*^9, {3.78967993553296*^9, 
   3.7896799839982586`*^9}, 3.7896800350036964`*^9, 3.7896803118245935`*^9, 
   3.789680387542113*^9, 3.789680418667269*^9, 3.789680456661158*^9, {
   3.78968066288806*^9, 3.7896806990267496`*^9}, 3.789681243641185*^9, 
   3.7896813179503717`*^9, 3.789681448905409*^9, {3.78968154083307*^9, 
   3.789681572585614*^9}, 3.789681812578278*^9, 3.789681876915442*^9, 
   3.789681944668223*^9, 3.789682012900092*^9, 3.7897500908303967`*^9, 
   3.7897501370021954`*^9, 3.789750225223452*^9, {3.7897502622105722`*^9, 
   3.7897502843813066`*^9}, {3.789751988313095*^9, 3.7897520043364563`*^9}, 
   3.78975397722719*^9, {3.7897568020070643`*^9, 3.789756893990237*^9}, {
   3.7897612244339724`*^9, 3.789761254302616*^9}, 3.7897612937706947`*^9, 
   3.789762068694903*^9, {3.789762257537299*^9, 3.789762277727049*^9}, 
   3.7897637916849575`*^9, 3.7897638447881174`*^9, 3.7897638851319523`*^9, {
   3.789764000739211*^9, 3.789764028638747*^9}, 3.789764064990918*^9, 
   3.789764095195032*^9, {3.789764265052706*^9, 3.789764273001545*^9}, 
   3.789764341261233*^9, {3.789764373771866*^9, 3.7897643990179815`*^9}, {
   3.789764507009956*^9, 3.7897645302292705`*^9}, 3.7897645676771326`*^9, 
   3.789766030099624*^9, {3.789766324038123*^9, 
   3.789766345067096*^9}},ExpressionUUID->"bde13c44-4960-4cdb-a7d9-\
c834f31705ee"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7894815251069455`*^9, 
  3.789481527967328*^9}},ExpressionUUID->"338dd63c-8d50-411f-8b34-\
4fd577058cd4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Defining", " ", "the", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Mu]", "[", "i_", "]"}], ":=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "1", "]"}], "\[Rule]", "3.2"}], 
       RowBox[{"(*", "glass", "*)"}], ",", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "3", "]"}], "\[Rule]", "2"}], 
       RowBox[{"(*", 
        RowBox[{"heavy", " ", "glass"}], "*)"}], ",", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "10.91"}], "+", 
          RowBox[{"0.83", "\[ImaginaryI]"}]}], ")"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"(*", 
        RowBox[{"-", "15"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Omega]p", "/", "\[Omega]"}], ")"}], "2"]}], ")"}], 
       "*)"}], 
      RowBox[{"(*", "metal", "*)"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars1", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "i", "]"}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"\[Kappa]", "[", "i", "]"}]}], "*)"}], ",", 
          RowBox[{"u", "[", "i", "]"}], ",", 
          RowBox[{"A", "[", "i", "]"}], ",", 
          RowBox[{"B", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Layers", "+", "3"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars2", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "\[Epsilon]", "]"}], ",", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"StringJoin", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "\[Kappa]", "]"}], ",", 
               RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "*)"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "u", "]"}], ",", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "A", "]"}], ",", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "B", "]"}], ",", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Layers", "+", "3"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"vars11", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"E0", "[", 
           RowBox[{"y", ",", "0"}], "]"}], ",", 
          RowBox[{"E0", "[", 
           RowBox[{"0", ",", "z"}], "]"}]}], "}"}], ",", "vars1"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars12", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"E0y", ",", "E0z"}], "}"}], ",", "vars2"}], "]"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Evaluate", "[", "vars11", "]"}], "=", "vars12"}]}]}]], "Input",
 CellChangeTimes->{{3.7888705661914897`*^9, 3.7888705767702456`*^9}, {
   3.788871197818219*^9, 3.7888713710740185`*^9}, {3.7888728313168807`*^9, 
   3.78887289645376*^9}, {3.788872938317853*^9, 3.7888729400602245`*^9}, {
   3.7888729754961596`*^9, 3.7888731538881865`*^9}, {3.788873658191519*^9, 
   3.788873701680309*^9}, 3.788876220176854*^9, {3.7888806953695345`*^9, 
   3.7888807060819287`*^9}, {3.7890775181283503`*^9, 3.789077539938979*^9}, {
   3.789302609853362*^9, 3.7893026260405583`*^9}, {3.7893027060496545`*^9, 
   3.789302737500264*^9}, {3.78930278645337*^9, 3.7893027972834682`*^9}, {
   3.789302967913125*^9, 3.7893029880981636`*^9}, {3.789303019116247*^9, 
   3.7893031240415163`*^9}, {3.789303156102813*^9, 3.789303170841423*^9}, {
   3.7893033575579176`*^9, 3.78930336964557*^9}, {3.789303694478507*^9, 
   3.7893037120943837`*^9}, {3.789306133759498*^9, 3.7893061378525295`*^9}, {
   3.789316245577607*^9, 3.789316296585269*^9}, {3.7893164874610004`*^9, 
   3.7893164897967606`*^9}, {3.7893170907295446`*^9, 
   3.7893172586087904`*^9}, {3.7893172889705973`*^9, 
   3.7893173587061872`*^9}, {3.7893201746245117`*^9, 3.78932019084756*^9}, {
   3.789474217878276*^9, 3.7894742287462244`*^9}, {3.7894742628181868`*^9, 
   3.789474277714363*^9}, {3.789474802253723*^9, 3.789474806563205*^9}, {
   3.789477665730548*^9, 3.789477670480852*^9}, {3.789477710446376*^9, 
   3.789477711900486*^9}, {3.789477767397137*^9, 3.789477790061551*^9}, {
   3.789477899102829*^9, 3.7894779245857077`*^9}, {3.78947916937883*^9, 
   3.78947917252242*^9}, {3.789479641190981*^9, 3.7894796680621505`*^9}, {
   3.7894798679677043`*^9, 3.7894798696024055`*^9}, {3.789494093617895*^9, 
   3.7894941153836784`*^9}, {3.789501534438636*^9, 3.7895015409591756`*^9}, {
   3.789569507292762*^9, 3.789569512588605*^9}, {3.7895696578818645`*^9, 
   3.789569665253131*^9}, {3.7895855334503574`*^9, 3.78958553703378*^9}, {
   3.789585683714223*^9, 3.7895856875320196`*^9}, {3.789585721260179*^9, 
   3.7895857252205925`*^9}, {3.789586524720869*^9, 3.789586528713197*^9}, {
   3.789677748652076*^9, 3.7896777796622005`*^9}, {3.7897500825505295`*^9, 
   3.789750084539212*^9}, {3.789751986149954*^9, 3.789752002640031*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"d3f9ea3a-b5d2-479e-8f12-bc3a61158db2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "E0y", ",", "E0z", ",", "\[Epsilon]1", ",", "u1", ",", "A1", ",", "B1", ",",
    "\[Epsilon]2", ",", "u2", ",", "A2", ",", "B2", ",", "\[Epsilon]3", ",", 
   "u3", ",", "A3", ",", "B3", ",", "\[Epsilon]4", ",", "u4", ",", "A4", ",", 
   "B4", ",", "\[Epsilon]5", ",", "u5", ",", "A5", ",", "B5", ",", 
   "\[Epsilon]6", ",", "u6", ",", "A6", ",", "B6"}], "}"}]], "Output",
 CellChangeTimes->{{3.7893166929746494`*^9, 3.789316738923155*^9}, 
   3.789316838167962*^9, 3.7893172672207375`*^9, {3.789317349190622*^9, 
   3.789317359098138*^9}, {3.7893185558076735`*^9, 3.789318571172188*^9}, 
   3.7893208734957466`*^9, {3.7893209115094075`*^9, 3.7893209148544674`*^9}, 
   3.789474282699999*^9, 3.7894746274699154`*^9, 3.789474810134654*^9, 
   3.7894766724376926`*^9, 3.7894775433742824`*^9, 3.7894777169649467`*^9, 
   3.7894777952367177`*^9, {3.7894779112802863`*^9, 3.7894779270710616`*^9}, {
   3.7894790537269816`*^9, 3.7894790775822144`*^9}, {3.7894791743175883`*^9, 
   3.789479215514868*^9}, {3.7894796457657514`*^9, 3.789479669653899*^9}, 
   3.7894797821682262`*^9, 3.7894798714713717`*^9, 3.7894826728614855`*^9, 
   3.7894829823505225`*^9, 3.7894832276848683`*^9, 3.7894834105359516`*^9, {
   3.7894834608776827`*^9, 3.7894835012966447`*^9}, {3.7894840063947735`*^9, 
   3.7894840126241217`*^9}, 3.7894840845408792`*^9, 3.7894841596856422`*^9, 
   3.7894845751863055`*^9, 3.789485037548033*^9, 3.789485103588411*^9, 
   3.7894851588562355`*^9, 3.7894852021136036`*^9, 3.789485275173051*^9, 
   3.789485310828742*^9, 3.7894854707493067`*^9, 3.7894855363269653`*^9, {
   3.7894855851813726`*^9, 3.7894856086267023`*^9}, 3.7894883606147294`*^9, 
   3.789490459646848*^9, 3.7894905260114465`*^9, 3.789490625544038*^9, 
   3.7894906711295424`*^9, 3.789492233922626*^9, 3.7894923522393875`*^9, 
   3.789493170708252*^9, {3.7894933778379498`*^9, 3.7894933973159094`*^9}, 
   3.7894934956963296`*^9, 3.7894939124557295`*^9, {3.7894941024901423`*^9, 
   3.789494127002618*^9}, {3.789494195351815*^9, 3.7894942188898993`*^9}, {
   3.789494274780072*^9, 3.789494299522602*^9}, {3.7894944068401237`*^9, 
   3.7894944754287834`*^9}, {3.789494518725251*^9, 3.7894946100262237`*^9}, {
   3.789494677286008*^9, 3.7894947122395735`*^9}, {3.789495209407008*^9, 
   3.789495225098998*^9}, 3.789495270118658*^9, 3.7894965787026634`*^9, {
   3.7894966210208564`*^9, 3.789496648989057*^9}, {3.7894967823743997`*^9, 
   3.789496816439502*^9}, 3.7894968729228153`*^9, 3.7894969698165655`*^9, 
   3.7894971529818797`*^9, {3.789497186975009*^9, 3.789497207506319*^9}, {
   3.7894972521160917`*^9, 3.789497282018159*^9}, 3.789497430193901*^9, {
   3.7894976391083765`*^9, 3.789497656545783*^9}, 3.7894977322294397`*^9, 
   3.7894978014476414`*^9, {3.7894978878600225`*^9, 3.7894979229741287`*^9}, 
   3.789498060232832*^9, {3.7894981067221236`*^9, 3.7894981303190536`*^9}, 
   3.789498183652568*^9, 3.789498300015671*^9, 3.7894983592210245`*^9, 
   3.789498407918844*^9, 3.789498454454484*^9, 3.789498513977481*^9, 
   3.789498554454312*^9, {3.7894986241476603`*^9, 3.789498636320122*^9}, 
   3.789498707498807*^9, {3.7894988170923615`*^9, 3.789498879186388*^9}, {
   3.7894989155402164`*^9, 3.7894989486628485`*^9}, 3.7894995952679887`*^9, 
   3.789499651180552*^9, {3.789500036902828*^9, 3.78950006157089*^9}, {
   3.7895001314690113`*^9, 3.7895001501502123`*^9}, 3.789500246614383*^9, 
   3.7895004162006207`*^9, 3.7895004704984465`*^9, 3.78950056384935*^9, 
   3.789500685775729*^9, 3.7895008009316015`*^9, {3.7895008432648773`*^9, 
   3.789500855123148*^9}, {3.78950089635102*^9, 3.7895009057511735`*^9}, 
   3.7895009894383464`*^9, 3.789501075125811*^9, 3.789501385981036*^9, 
   3.7895015429100065`*^9, 3.78950158665565*^9, 3.7895016917244716`*^9, 
   3.7895019759557047`*^9, 3.7895020812511864`*^9, {3.789502136570676*^9, 
   3.789502159500414*^9}, 3.789502250137186*^9, 3.789502334295001*^9, 
   3.7895023856805377`*^9, {3.7895024379573174`*^9, 3.7895024525044622`*^9}, {
   3.7895024981445265`*^9, 3.789502505462962*^9}, 3.7895025517743797`*^9, 
   3.789565457471593*^9, 3.789565578079564*^9, 3.7895656194141984`*^9, 
   3.78956569503528*^9, 3.7895657642572126`*^9, 3.789565794959564*^9, 
   3.7895662953290825`*^9, {3.789566331976592*^9, 3.7895663544645743`*^9}, 
   3.7895664398586783`*^9, {3.789566885750335*^9, 3.7895669051724167`*^9}, 
   3.7895670271078863`*^9, 3.789567072402834*^9, 3.7895671563698597`*^9, 
   3.7895675341335106`*^9, {3.789567744714887*^9, 3.789567790536392*^9}, 
   3.7895690783145237`*^9, {3.7895691088549423`*^9, 3.789569114981099*^9}, {
   3.78956932852264*^9, 3.789569346928449*^9}, 3.7895694082113824`*^9, 
   3.7895695163375826`*^9, 3.789569667655739*^9, 3.789569749057692*^9, 
   3.789570093341369*^9, 3.7895702134617043`*^9, {3.78957038265242*^9, 
   3.789570456230316*^9}, 3.7895705059157915`*^9, 3.7895705860845304`*^9, 
   3.789570780807326*^9, 3.7895709154033623`*^9, 3.7895709525472174`*^9, 
   3.7895710233678737`*^9, 3.789571093209304*^9, 3.7895716279652967`*^9, 
   3.789571844476259*^9, 3.7895719488619685`*^9, 3.789572040645966*^9, 
   3.789572080249771*^9, 3.7895722211219935`*^9, {3.7895722596154375`*^9, 
   3.7895722736764174`*^9}, {3.7895723075478745`*^9, 3.7895723548115616`*^9}, 
   3.7895723975401196`*^9, {3.7895724483067565`*^9, 3.7895724950868673`*^9}, 
   3.7895739751753287`*^9, {3.7895852238469515`*^9, 3.7895852582611723`*^9}, 
   3.7895855388958006`*^9, {3.78958563695123*^9, 3.7895856528746605`*^9}, 
   3.7895856935761847`*^9, 3.7895857271324816`*^9, {3.7895862846343465`*^9, 
   3.7895863015471077`*^9}, {3.7895863414466705`*^9, 3.7895863656409965`*^9}, 
   3.7895864004090576`*^9, {3.7895864587033463`*^9, 3.7895864876030903`*^9}, {
   3.789586530637083*^9, 3.7895865324222813`*^9}, 3.7895878578507223`*^9, 
   3.7895879769960113`*^9, 3.789588021933016*^9, 3.789588278263033*^9, 
   3.7895889096767178`*^9, 3.789659148904319*^9, 3.7896749857844706`*^9, 
   3.7896761256845274`*^9, {3.7896762713766537`*^9, 3.7896763000302134`*^9}, 
   3.7896769289856973`*^9, 3.789677569438424*^9, {3.789677755170806*^9, 
   3.7896777823052087`*^9}, 3.789678143581736*^9, 3.789678435060438*^9, 
   3.7896785289114046`*^9, {3.789678686138528*^9, 3.7896787142266192`*^9}, 
   3.7896787613690577`*^9, 3.789678823790359*^9, 3.7896789899972167`*^9, 
   3.7896796591709695`*^9, 3.7896797531021786`*^9, {3.7896799357640686`*^9, 
   3.789679984104739*^9}, 3.789680035221595*^9, 3.7896803122086754`*^9, 
   3.789680387754656*^9, 3.7896804189036756`*^9, 3.7896804571367645`*^9, {
   3.7896806631246557`*^9, 3.789680699218648*^9}, 3.7896812438921385`*^9, 
   3.7896813182723794`*^9, 3.789681449238704*^9, {3.789681540996845*^9, 
   3.7896815728212895`*^9}, 3.7896818128023443`*^9, 3.7896818771221704`*^9, 
   3.7896819449474*^9, 3.7896820131659365`*^9, 3.7897500909042*^9, 
   3.7897501370740767`*^9, 3.7897502253012357`*^9, {3.7897502622873654`*^9, 
   3.7897502844590983`*^9}, {3.789751988382909*^9, 3.7897520044052725`*^9}, 
   3.7897539772840385`*^9, {3.7897568020708914`*^9, 3.789756894056076*^9}, {
   3.789761224478881*^9, 3.7897612543338428`*^9}, 3.789761293817562*^9, 
   3.78976206874477*^9, {3.789762257596506*^9, 3.7897622777639494`*^9}, 
   3.7897637917298374`*^9, 3.7897638448419724`*^9, 3.789763885163167*^9, {
   3.78976400078808*^9, 3.789764028690609*^9}, 3.7897640650221586`*^9, 
   3.7897640952263064`*^9, 3.7897642650995693`*^9, 3.789764341306115*^9, {
   3.7897643738187532`*^9, 3.7897643990718107`*^9}, {3.78976450707241*^9, 
   3.7897645302771096`*^9}, 3.7897645677170687`*^9, 3.789766030156471*^9, {
   3.789766324100644*^9, 
   3.7897663451139607`*^9}},ExpressionUUID->"abb0f270-f1c8-4442-bd3b-\
0be9549442fd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"params1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "\[Rule]", "1"}], ",", 
      RowBox[{"B1", "\[Rule]", "r"}], ",", 
      RowBox[{"A3", "\[Rule]", "t"}], ",", 
      RowBox[{"A4", "\[Rule]", "0"}], ",", 
      RowBox[{"B4", "\[Rule]", "r"}], ",", 
      RowBox[{"A6", "\[Rule]", "t"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7894743102463646`*^9, 3.7894743581410913`*^9}, {
   3.78947439206042*^9, 3.7894743974151077`*^9}, 3.7894746243741927`*^9, {
   3.7894749382007136`*^9, 3.789474942027482*^9}, {3.789475059149993*^9, 
   3.789475091862548*^9}, {3.789496565642573*^9, 3.7894965678975134`*^9}, 
   3.789497605565069*^9, {3.7894977925940933`*^9, 3.7894977973164577`*^9}, {
   3.7895000340514517`*^9, 3.7895000343346643`*^9}, {3.78950012540824*^9, 
   3.7895001294174953`*^9}, {3.7895021216475945`*^9, 3.789502151097845*^9}, 
   3.7895022449818726`*^9},ExpressionUUID->"75ff96c5-180f-43a3-9879-\
a389e0d44cc2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Field", " ", "Equations"}], "*)"}]], "Input",ExpressionUUID->\
"23f610d2-4a51-4403-8c30-6b53523b6709"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Helmholtz1", "[", "index_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["k0", "2"], 
      RowBox[{"\[Epsilon]", "[", "index", "]"}], 
      RowBox[{"\[Mu]", "[", "index", "]"}]}], "-", 
     SuperscriptBox["k", "2"], "+", 
     SuperscriptBox[
      RowBox[{"\[Kappa]", "[", "index", "]"}], "2"]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"helmholtz", " ", "equation"}], "*)"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hfieldin", "[", 
     RowBox[{"z_", ",", "index_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "index", "]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"\[Kappa]", "[", "index", "]"}], 
              RowBox[{"(", "z", 
               RowBox[{"(*", 
                RowBox[{"-", "d"}], "*)"}], ")"}]}]], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{" ", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", "y", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t"}], 
                "*)"}]}]}]]}], 
           RowBox[{"(*", 
            RowBox[{"E0", "[", "z", "]"}], "*)"}], ",", 
           RowBox[{"index", "\[Equal]", "3"}]}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "index", "]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"\[Kappa]", "[", "index", "]"}], "z"}]]}], "+", 
           RowBox[{
            RowBox[{"B", "[", "index", "]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", " ", "\[ImaginaryI]"}], " ", 
              RowBox[{"\[Kappa]", "[", "index", "]"}], "z"}]]}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{" ", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "y", " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t"}], 
             "*)"}]}]}]]}]}], "]"}], ",", "0", ",", "0"}], "}"}]}], "  ", 
   RowBox[{"(*", 
    RowBox[{"Transverse", " ", "field", " ", "along", " ", "x"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Hfieldsc", "[", 
      RowBox[{"z_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"index", "+", "Layers"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"\[Kappa]", "[", 
                RowBox[{"index", "+", "Layers"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"z", "-", "d"}], ")"}]}]], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{" ", 
               RowBox[{"\[ImaginaryI]", " ", "k", " ", "y", " ", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t"}],
                  "*)"}]}]}]]}], 
            RowBox[{"(*", 
             RowBox[{"E0", "[", "z", "]"}], "*)"}], ",", 
            RowBox[{"index", "\[Equal]", "3"}]}], "}"}], "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"index", "+", "Layers"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"\[Kappa]", "[", 
                RowBox[{"index", "+", "Layers"}], "]"}], "z"}]]}], "+", 
            RowBox[{
             RowBox[{"B", "[", 
              RowBox[{"index", "+", "Layers"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", " ", "\[ImaginaryI]"}], " ", 
               RowBox[{"\[Kappa]", "[", 
                RowBox[{"index", "+", "Layers"}], "]"}], "z"}]]}]}], ")"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{" ", 
            RowBox[{"\[ImaginaryI]", " ", "k", " ", "y", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t"}], 
              "*)"}]}]}]]}]}], "]"}], ",", "0", ",", "0"}], "}"}]}], "  ", 
    RowBox[{"(*", 
     RowBox[{"Transverse", " ", "field", " ", "along", " ", "x"}], "*)"}], 
    "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Efields", " ", "corresponding", " ", "to", " ", "it", " ", "in", " ", 
     "different", " ", "directions"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Efieldin", "[", 
      RowBox[{"z_", ",", "index_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " "}], 
        RowBox[{"k0", "  ", 
         RowBox[{"\[Epsilon]", "[", "index", "]"}]}]], 
       RowBox[{"Curl", "[", 
        RowBox[{
         RowBox[{"Hfieldin", "[", 
          RowBox[{"z", ",", "index"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"E0", "[", "z", "]"}], ",", "z"}], "]"}], "\[RuleDelayed]", 
        "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Efield2", "[", 
       RowBox[{"z_", ",", "index_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"\[ImaginaryI]", " "}], 
         RowBox[{"k0", "  ", 
          RowBox[{"\[Epsilon]", "[", "index", "]"}]}]], 
        RowBox[{"Curl", "[", 
         RowBox[{
          RowBox[{"Hfieldsc", "[", 
           RowBox[{"z", ",", "index"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"E0", "[", "z", "]"}], ",", "z"}], "]"}], "\[RuleDelayed]",
          "0"}], "}"}]}]}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.789316324683137*^9, 3.7893164396408606`*^9}, {
   3.7893167111623716`*^9, 3.78931673330617*^9}, {3.7893168089191475`*^9, 
   3.7893168155464582`*^9}, {3.789473905295864*^9, 3.789473905468407*^9}, {
   3.7894739354801702`*^9, 3.789473969217964*^9}, 3.789474003763954*^9, {
   3.789474142152649*^9, 3.789474184670553*^9}, {3.789474414099507*^9, 
   3.7894744479460297`*^9}, {3.7894745528511343`*^9, 3.78947459484313*^9}, {
   3.7894746784586153`*^9, 3.7894746832418604`*^9}, {3.78947471684503*^9, 
   3.7894747641236477`*^9}, {3.7894748325753746`*^9, 
   3.7894748912758603`*^9}, {3.789475110502718*^9, 3.789475120908901*^9}, {
   3.7894753921453795`*^9, 3.789475410908225*^9}, {3.7894754923014555`*^9, 
   3.7894755125243683`*^9}, 3.789483200098431*^9, {3.789483381044786*^9, 
   3.7894834079927783`*^9}, {3.78948348227551*^9, 3.789483496904377*^9}, {
   3.789490456013559*^9, 3.789490457533498*^9}, {3.7894906164822617`*^9, 
   3.789490624058011*^9}, 3.7894933954269323`*^9, 3.789493493843311*^9, {
   3.7894952073175945`*^9, 3.789495223298807*^9}, {3.789496618196401*^9, 
   3.7894966197322645`*^9}, 3.789497596200101*^9, 3.789497730224839*^9, 
   3.78949781572149*^9, {3.7894981047613664`*^9, 3.7894981396601453`*^9}, 
   3.7895023743009253`*^9, 3.789762066414955*^9},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"123f0ae6-d7d5-4b5c-a632-8ad1ed7d2091"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Hfieldin", "[", 
      RowBox[{"z", ",", "i"}], "]"}], "/.", "params1"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"Magnetic", " ", "Field"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.789316308529315*^9, {3.78947463020763*^9, 3.7894747022111783`*^9}, 
   3.7894782175343313`*^9, 3.7894840802942314`*^9, {3.789488352872427*^9, 
   3.7894883571460023`*^9}, 3.789490559879568*^9, 3.78949066444641*^9, {
   3.789491066520259*^9, 3.7894910932198873`*^9}, {3.7894923318235316`*^9, 
   3.7894923470392885`*^9}, {3.7897523563391666`*^9, 
   3.789752367444583*^9}},ExpressionUUID->"e1bd07e3-1bde-48ff-ab9b-\
46f16140e6aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", "y"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "z", " ", 
          RowBox[{"\[Kappa]", "[", "1", "]"}]}]], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "z", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", "r"}]}], ")"}]}], ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", "y"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "z", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}], "+", 
        RowBox[{"A2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}]}], ")"}]}], ",", "0", ",",
      "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "k", " ", "y"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "z", " ", 
         RowBox[{"\[Kappa]", "[", "3", "]"}]}]}]], " ", "t"}], ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.789488360713465*^9, 3.7894904597405963`*^9, 3.7894905261091847`*^9, 
   3.789490567518201*^9, 3.7894906256378145`*^9, {3.7894906650916824`*^9, 
   3.7894906712272935`*^9}, {3.789491067197447*^9, 3.789491093908046*^9}, 
   3.789492234022359*^9, {3.7894923475110273`*^9, 3.7894923523401184`*^9}, 
   3.7894931708079853`*^9, {3.789493377952643*^9, 3.7894933974016533`*^9}, 
   3.7894934957850924`*^9, 3.789493912558457*^9, {3.7894941025779085`*^9, 
   3.789494127097366*^9}, {3.7894941954475584`*^9, 3.789494218985639*^9}, {
   3.7894942748867874`*^9, 3.7894942996203413`*^9}, {3.789494406945842*^9, 
   3.789494475525526*^9}, {3.789494518823987*^9, 3.78949461012097*^9}, {
   3.789494677381753*^9, 3.7894947123353176`*^9}, {3.7894952094947734`*^9, 
   3.7894952251987276`*^9}, 3.7894952702233715`*^9, 3.7894965788721795`*^9, {
   3.789496621113601*^9, 3.789496649088791*^9}, {3.78949677789839*^9, 
   3.7894968165342703`*^9}, 3.789496873036541*^9, 3.7894969699192767`*^9, 
   3.78949715307859*^9, {3.78949718706976*^9, 3.7894972076060343`*^9}, {
   3.7894972522257977`*^9, 3.7894972821208878`*^9}, 3.789497430300616*^9, {
   3.789497621020746*^9, 3.789497656642521*^9}, 3.7894977323341613`*^9, {
   3.7894978015453844`*^9, 3.7894978279906607`*^9}, {3.7894978879667387`*^9, 
   3.7894979230778823`*^9}, 3.7894980603325653`*^9, {3.789498106815872*^9, 
   3.7894981304227705`*^9}, 3.789498183752267*^9, 3.7894983001253448`*^9, 
   3.78949835932574*^9, 3.789498408026559*^9, 3.7894984545641603`*^9, 
   3.7894985140852227`*^9, 3.7894985545610237`*^9, {3.789498624256398*^9, 
   3.789498636445792*^9}, 3.7894987076045256`*^9, {3.789498817207038*^9, 
   3.789498879282132*^9}, {3.7894989156449337`*^9, 3.789498948764581*^9}, 
   3.7894995953607397`*^9, 3.78949965126932*^9, {3.7895000369776344`*^9, 
   3.7895000616556315`*^9}, {3.789500131545806*^9, 3.789500150228033*^9}, 
   3.789500246696196*^9, 3.789500416279415*^9, 3.7895004705752716`*^9, 
   3.7895005639390793`*^9, 3.7895006858585405`*^9, 3.7895008010462737`*^9, {
   3.789500843372587*^9, 3.7895008552298627`*^9}, {3.7895008964527454`*^9, 
   3.789500905862913*^9}, 3.789500989543068*^9, 3.789501075238487*^9, 
   3.789501386058829*^9, 3.789501542983795*^9, 3.7895015867324467`*^9, 
   3.7895016918082495`*^9, 3.7895019760674076`*^9, 3.7895020813728585`*^9, {
   3.789502136670409*^9, 3.789502163246465*^9}, 3.789502253746525*^9, 
   3.7895023344036784`*^9, 3.789502385815629*^9, {3.7895024380700164`*^9, 
   3.7895024526131563`*^9}, {3.789502498253236*^9, 3.789502505570142*^9}, 
   3.7895025518920374`*^9, 3.7895654576131887`*^9, 3.7895655819442315`*^9, 
   3.789565619505924*^9, 3.789565695116064*^9, 3.7895657643529825`*^9, 
   3.789565795057479*^9, 3.789566295432308*^9, {3.789566332080347*^9, 
   3.7895663545622835`*^9}, 3.7895664399634*^9, {3.789566885838128*^9, 
   3.7895669052661653`*^9}, 3.7895670272006383`*^9, 3.7895670724985785`*^9, 
   3.78956715647561*^9, 3.7895675342292547`*^9, {3.78956774482658*^9, 
   3.7895677906411443`*^9}, 3.789569078408301*^9, {3.789569108953679*^9, 
   3.7895691150857935`*^9}, {3.789569328627332*^9, 3.7895693470341434`*^9}, 
   3.789569408315138*^9, 3.789569516437316*^9, 3.789569667752451*^9, 
   3.789569749160412*^9, 3.789570093444068*^9, 3.7895702135744505`*^9, {
   3.789570382764121*^9, 3.7895704563316135`*^9}, 3.7895705060234995`*^9, 
   3.789570586190281*^9, 3.789570780910051*^9, 3.7895709155041018`*^9, 
   3.789570952655896*^9, 3.7895710234706*^9, 3.789571093312028*^9, 
   3.789571628060092*^9, 3.7895718445700536`*^9, 3.7895719489526973`*^9, 
   3.789572040740741*^9, 3.789572080357512*^9, 3.789572221236015*^9, {
   3.7895722597251234`*^9, 3.7895722737811656`*^9}, {3.789572307653623*^9, 
   3.7895723549122934`*^9}, 3.7895723976468925`*^9, {3.7895724484075775`*^9, 
   3.7895724951866055`*^9}, 3.789573975274982*^9, {3.789585224028466*^9, 
   3.7895852583619027`*^9}, 3.789585538993539*^9, {3.7895856370529547`*^9, 
   3.789585652969407*^9}, 3.789585693652977*^9, 3.789585727224236*^9, {
   3.7895862847350755`*^9, 3.7895863016478376`*^9}, {3.7895863415374284`*^9, 
   3.7895863657397327`*^9}, 3.7895864005057983`*^9, {3.7895864587921047`*^9, 
   3.78958648769983*^9}, 3.7895865325100574`*^9, 3.7895878579524508`*^9, 
   3.789587977084767*^9, 3.7895880220297575`*^9, 3.7895882783547883`*^9, 
   3.7895889097724705`*^9, 3.789659149357912*^9, 3.7896749861018167`*^9, 
   3.789676125892082*^9, {3.789676272057517*^9, 3.7896763007071075`*^9}, 
   3.7896769293859205`*^9, 3.789677569812619*^9, {3.789677755529145*^9, 
   3.7896777826418467`*^9}, 3.7896781441844296`*^9, 3.789678435272921*^9, 
   3.78967852936489*^9, {3.7896786865679493`*^9, 3.789678714571763*^9}, 
   3.7896787617759504`*^9, 3.789678824183297*^9, 3.7896789901754904`*^9, 
   3.789679659376248*^9, 3.789679753610031*^9, {3.789679936295626*^9, 
   3.789679984282797*^9}, 3.7896800355916877`*^9, 3.789680312841651*^9, 
   3.7896803881530066`*^9, 3.7896804195723906`*^9, 3.789680457875221*^9, {
   3.7896806635054007`*^9, 3.789680699590537*^9}, 3.7896812445576353`*^9, 
   3.7896813189813504`*^9, 3.789681449482515*^9, {3.789681541184162*^9, 
   3.7896815732518406`*^9}, 3.789681813193755*^9, 3.7896818774547057`*^9, 
   3.7896819455586977`*^9, 3.7896820138008285`*^9, 3.7897500910368457`*^9, 
   3.7897501372196875`*^9, 3.7897502254528294`*^9, {3.7897502624220066`*^9, 
   3.7897502845987263`*^9}, {3.789751988521542*^9, 3.789752004544899*^9}, 
   3.789753977398731*^9, {3.7897568022055035`*^9, 3.7897568941982117`*^9}, {
   3.7897612245657144`*^9, 3.7897612544119773`*^9}, 3.789761293886591*^9, 
   3.7897620688375216`*^9, {3.7897622576832705`*^9, 3.789762277847756*^9}, 
   3.7897637918166323`*^9, 3.7897638449297404`*^9, 3.789763885241282*^9, {
   3.7897640008778405`*^9, 3.789764028776408*^9}, 3.789764065115885*^9, 
   3.789764095304412*^9, 3.789764265177676*^9, 3.7897643414048758`*^9, {
   3.789764373896857*^9, 3.789764399165592*^9}, {3.78976450716617*^9, 
   3.7897645303768435`*^9}, 3.789764567802086*^9, 3.789766030264181*^9, {
   3.789766324209959*^9, 
   3.789766345238963*^9}},ExpressionUUID->"9d20f56d-8d0e-42ca-be6d-\
87bdee79a086"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Efieldin", "[", 
      RowBox[{"z", ",", "i"}], "]"}], "/.", "params1"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"Electric", " ", "Field"}], "*)"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.789483215213212*^9, 3.789483275217908*^9}, 
   3.789483482281466*^9, 3.7894840822799273`*^9, 3.7894883537091885`*^9, 
   3.7894905611581497`*^9, {3.7894924026975102`*^9, 3.789492422712248*^9}, {
   3.789752372980783*^9, 3.789752379905305*^9}, {3.789762247819745*^9, 
   3.789762270521925*^9}},ExpressionUUID->"599aae47-3807-4290-b504-\
3da1d9f22c2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "y"}], "-", 
            RowBox[{"z", " ", 
             RowBox[{"\[Kappa]", "[", "1", "]"}]}]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "z", " ", 
            RowBox[{"\[Kappa]", "[", "1", "]"}]}]], "-", "r"}], ")"}], " ", 
        RowBox[{"\[Kappa]", "[", "1", "]"}]}], 
       RowBox[{"k0", " ", "\[Epsilon]1"}]]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", " ", "y"}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"\[Kappa]", "[", "1", "]"}]}]}], ")"}]}]], " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "z", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}]], "+", "r"}], ")"}]}], 
      RowBox[{"k0", " ", "\[Epsilon]1"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "y"}], "-", 
            RowBox[{"z", " ", 
             RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "B2"}], "+", 
          RowBox[{"A2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "z", " ", 
             RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}]}], ")"}], " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}], 
       RowBox[{"k0", " ", "\[Epsilon]2"}]]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", " ", "y"}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"B2", "+", 
         RowBox[{"A2", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "z", " ", 
            RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}]}], ")"}], " ", "k"}], 
      RowBox[{"k0", " ", "\[Epsilon]2"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "y"}], "+", 
            RowBox[{"z", " ", 
             RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]], " ", "t", " ", 
        RowBox[{"\[Kappa]", "[", "3", "]"}]}], 
       RowBox[{"k0", " ", "\[Epsilon]3"}]]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", " ", "y"}], "+", 
           RowBox[{"z", " ", 
            RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]], " ", "k", " ", 
       "t"}], 
      RowBox[{"k0", " ", "\[Epsilon]3"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7894883542706876`*^9, 3.789488360744383*^9}, 
   3.78949045976952*^9, 3.789490526140103*^9, 3.7894905620796847`*^9, 
   3.789490625668704*^9, 3.789492234051282*^9, 3.789492423317596*^9, 
   3.7894931708428917`*^9, {3.7894933779865527`*^9, 3.7894933974365606`*^9}, 
   3.7894934958199987`*^9, 3.7894939125923653`*^9, {3.7894941026108236`*^9, 
   3.789494127130765*^9}, {3.78949419548446*^9, 3.7894942190175543`*^9}, {
   3.7894942749226913`*^9, 3.7894942996542516`*^9}, {3.7894944069837503`*^9, 
   3.789494475558438*^9}, {3.7894945188588934`*^9, 3.789494610153883*^9}, {
   3.789494677416659*^9, 3.7894947123692384`*^9}, {3.7894952095296803`*^9, 
   3.789495225238621*^9}, 3.789495270259276*^9, 3.7894965789110746`*^9, {
   3.7894966211474805`*^9, 3.7894966491266875`*^9}, {3.789496777942278*^9, 
   3.789496816571122*^9}, 3.7894968730734787`*^9, 3.789496969958159*^9, 
   3.7894971531144934`*^9, {3.7894971871066284`*^9, 3.789497207644925*^9}, {
   3.789497252258709*^9, 3.7894972821582055`*^9}, 3.789497430341507*^9, {
   3.7894976210616055`*^9, 3.789497656681389*^9}, 3.789497732373057*^9, {
   3.789497801581257*^9, 3.789497828068454*^9}, {3.7894978880046062`*^9, 
   3.78949792311176*^9}, 3.789498060369467*^9, {3.7894981068428*^9, 
   3.789498130460724*^9}, 3.789498183789199*^9, 3.7894983001612854`*^9, 
   3.7894983593596506`*^9, 3.789498408062462*^9, 3.789498454603084*^9, 
   3.7894985141211276`*^9, 3.7894985545969353`*^9, {3.7894986242982583`*^9, 
   3.789498636480693*^9}, 3.7894987076414566`*^9, {3.789498817246932*^9, 
   3.789498879317012*^9}, {3.789498915679837*^9, 3.7894989488024473`*^9}, 
   3.789499595388694*^9, 3.7894996513041954`*^9, {3.789500037011509*^9, 
   3.7895000616855803`*^9}, {3.789500131576739*^9, 3.789500150256956*^9}, 
   3.789500246726117*^9, 3.7895004163112946`*^9, 3.789500470606157*^9, 
   3.78950056397202*^9, 3.7895006858944135`*^9, 3.789500801087592*^9, {
   3.7895008434104586`*^9, 3.789500855263775*^9}, {3.7895008964906187`*^9, 
   3.789500905901802*^9}, 3.7895009895829277`*^9, 3.789501075273414*^9, 
   3.7895013860887785`*^9, 3.789501543015709*^9, 3.7895015867623663`*^9, 
   3.789501691841163*^9, 3.78950197610531*^9, 3.789502081414719*^9, {
   3.7895021367083087`*^9, 3.789502173090151*^9}, 3.789502253829313*^9, 
   3.789502334441606*^9, 3.7895023858545256`*^9, {3.789502438110935*^9, 
   3.789502452652068*^9}, {3.7895024982921305`*^9, 3.789502505608035*^9}, 
   3.7895025519299316`*^9, 3.7895654576431503`*^9, 3.7895655819771433`*^9, 
   3.7895656195408573`*^9, 3.7895656951479483`*^9, 3.789565764384899*^9, 
   3.7895657950873995`*^9, 3.789566295467184*^9, {3.789566332114256*^9, 
   3.7895663545962234`*^9}, 3.789566440001297*^9, {3.789566885876026*^9, 
   3.7895669053010736`*^9}, 3.7895670272405305`*^9, 3.789567072538474*^9, 
   3.789567156512479*^9, 3.7895675342661314`*^9, {3.78956774486648*^9, 
   3.789567790683034*^9}, 3.789569078445202*^9, {3.7895691089905825`*^9, 
   3.789569115130675*^9}, {3.7895693286682367`*^9, 3.789569347074481*^9}, 
   3.789569408353054*^9, 3.7895695164712553`*^9, 3.7895696677883844`*^9, 
   3.7895697491973124`*^9, 3.7895700934829936`*^9, 3.789570213610306*^9, {
   3.789570382800031*^9, 3.7895704563735313`*^9}, 3.7895705060633965`*^9, 
   3.7895705862271757`*^9, 3.789570780945984*^9, 3.7895709155449824`*^9, 
   3.7895709526948233`*^9, 3.7895710235085278`*^9, 3.789571093349928*^9, 
   3.789571628095948*^9, 3.789571844605918*^9, 3.7895719489896*^9, 
   3.7895720407756486`*^9, 3.7895720804013968`*^9, 3.7895722212709436`*^9, {
   3.7895722597610197`*^9, 3.789572273818039*^9}, {3.7895723076974745`*^9, 
   3.789572354949195*^9}, 3.7895723976847677`*^9, {3.789572448444505*^9, 
   3.7895724952245007`*^9}, 3.789573975312874*^9, {3.7895852240653677`*^9, 
   3.789585258395812*^9}, 3.789585539028446*^9, {3.789585637087861*^9, 
   3.7895856530043144`*^9}, 3.7895856936928825`*^9, 3.789585727263132*^9, {
   3.7895862847709827`*^9, 3.7895863016877317`*^9}, {3.7895863415723352`*^9, 
   3.789586365772644*^9}, 3.789586400541703*^9, {3.789586458827011*^9, 
   3.7895864877367353`*^9}, 3.7895865325419617`*^9, 3.7895878579883547`*^9, 
   3.7895879771196747`*^9, 3.7895880220716457`*^9, 3.7895882783906918`*^9, 
   3.7895889098073683`*^9, 3.7896591495042753`*^9, 3.7896749862582197`*^9, 
   3.7896761260199246`*^9, {3.789676272424165*^9, 3.789676301060542*^9}, 
   3.7896769296141863`*^9, 3.789677570039543*^9, {3.789677755711426*^9, 
   3.789677782808115*^9}, 3.7896781444403486`*^9, 3.7896784354030604`*^9, 
   3.7896785297720065`*^9, {3.7896786868116937`*^9, 3.789678714770645*^9}, 
   3.7896787621262264`*^9, 3.789678824398677*^9, 3.789678990266096*^9, 
   3.789679659498931*^9, 3.7896797536819515`*^9, {3.789679936445786*^9, 
   3.7896799843934426`*^9}, 3.7896800360022926`*^9, 3.7896803129592543`*^9, 
   3.7896803885995398`*^9, 3.789680419836605*^9, 3.7896804582882175`*^9, {
   3.7896806638998365`*^9, 3.789680699781027*^9}, 3.789681244789198*^9, 
   3.7896813192486205`*^9, 3.789681449822221*^9, {3.789681541294406*^9, 
   3.7896815734934893`*^9}, 3.7896818133786125`*^9, 3.78968187761211*^9, 
   3.789681945802945*^9, 3.7896820140187225`*^9, 3.789750091083721*^9, 
   3.7897501372615757`*^9, 3.78975022549771*^9, {3.789750262465904*^9, 
   3.789750284644603*^9}, {3.7897519885644226`*^9, 3.7897520045887823`*^9}, 
   3.789753977437628*^9, {3.7897568022504115`*^9, 3.789756894242072*^9}, {
   3.7897612245857596`*^9, 3.78976125444322*^9}, 3.789761293917862*^9, 
   3.7897620688784113`*^9, {3.789762252334436*^9, 3.7897622778826337`*^9}, 
   3.789763791852516*^9, 3.7897638450284753`*^9, 3.7897638853193755`*^9, {
   3.789764000975581*^9, 3.789764028858175*^9}, 3.789764065193997*^9, 
   3.7897640953824883`*^9, 3.7897642652557817`*^9, 3.789764341481642*^9, {
   3.789764373974936*^9, 3.7897643992354093`*^9}, {3.7897645072442737`*^9, 
   3.78976453045264*^9}, 3.789764567867015*^9, 3.7897660303489537`*^9, {
   3.7897663243037195`*^9, 
   3.789766345363902*^9}},ExpressionUUID->"421c4237-c4f4-4d37-87fc-\
149d09ffae14"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Boundary", " ", "Conditions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.789316828941653*^9, 
  3.7893168364086943`*^9}},ExpressionUUID->"5d84c930-f1e6-4cbc-b1f8-\
520a322ef9c9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"<<", "EqualThread"}], ".", "m"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.789565586717473*^9},ExpressionUUID->"5bdcdf6a-7199-41e0-a62c-\
6506a5dff00e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"d1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "d"}], ",", "0"}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Maxwell", " ", "Boundary", " ", "condition", " ", "at", " ", "two", " ", 
     "interfaces", " ", "d"}], "=", 
    RowBox[{
     RowBox[{"0", " ", "and", " ", "d"}], "=", "d"}]}], "*)"}]}], "\n", 
 RowBox[{"eqns", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"(*", "eqnhelm", "*)"}], 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Hfieldin", "[", 
               RowBox[{
                RowBox[{"d1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], ",", "k1"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"Hfieldin", "[", 
               RowBox[{
                RowBox[{"d1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], ",", 
                RowBox[{"k1", "+", "1"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Efieldin", "[", 
               RowBox[{
                RowBox[{"d1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], ",", "k1"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"Efieldin", "[", 
               RowBox[{
                RowBox[{"d1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], ",", 
                RowBox[{"k1", "+", "1"}]}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Layers", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], "}"}], 
     "]"}], "/.", "params1"}], "/.", 
   RowBox[{"y", "\[Rule]", "0"}]}]}]}], "Input",
 CellChangeTimes->{{3.7893165133089075`*^9, 3.7893166260894575`*^9}, {
   3.7893202901494064`*^9, 3.7893203013843718`*^9}, 3.7893208917492275`*^9, {
   3.78947545863046*^9, 3.789475480643587*^9}, {3.7894755241881886`*^9, 
   3.789475531324111*^9}, {3.78948348228745*^9, 3.7894834822924366`*^9}, {
   3.7894980525662966`*^9, 3.789498054494181*^9}, {3.7895006772595267`*^9, 
   3.7895007148999057`*^9}, {3.789500779185147*^9, 3.789500799053031*^9}, {
   3.7895021837374973`*^9, 3.7895021839509344`*^9}, {3.789761219475276*^9, 
   3.789761252771737*^9}, {3.789763840036398*^9, 3.789763842834676*^9}, {
   3.789763880619467*^9, 3.7897638834747996`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"3cd8c3b6-4f75-445d-b61e-fcf00960bed6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
       RowBox[{"\[Kappa]", "[", "1", "]"}]}]], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "d", " ", 
        RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", "r"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"A2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}], "+", 
     RowBox[{"B2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "d", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", 
         RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "d", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", "r", " ", 
         RowBox[{"\[Kappa]", "[", "1", "]"}]}]}], ")"}]}], 
     RowBox[{"k0", " ", "\[Epsilon]1"}]], "\[Equal]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "A2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]], " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "B2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "d", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]], " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}]}], 
     RowBox[{"k0", " ", "\[Epsilon]2"}]]}], ",", 
   RowBox[{
    RowBox[{"A2", "+", "B2"}], "\[Equal]", "t"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "A2", " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "B2", " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}]}], 
     RowBox[{"k0", " ", "\[Epsilon]2"}]], "\[Equal]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"t", " ", 
       RowBox[{"\[Kappa]", "[", "3", "]"}]}], 
      RowBox[{"k0", " ", "\[Epsilon]3"}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7894755167560525`*^9, 3.7894755322277036`*^9}, 
   3.789476672624194*^9, 3.789477543564773*^9, 3.789477717170409*^9, 
   3.7894777954481516`*^9, {3.7894779114787664`*^9, 3.789477927285488*^9}, {
   3.7894790540032434`*^9, 3.7894790778475046`*^9}, {3.78947917458132*^9, 
   3.7894792157791624`*^9}, {3.789479646100856*^9, 3.7894796699710474`*^9}, 
   3.7894797824355116`*^9, 3.7894798717356653`*^9, 3.789482673222521*^9, 
   3.7894829826068535`*^9, 3.789483410798251*^9, 3.7894835120758266`*^9, 
   3.789484084715413*^9, 3.7894841598452168`*^9, 3.789484575361837*^9, 
   3.7894850377144995`*^9, 3.789485103776908*^9, 3.789485159053707*^9, 
   3.789485202284147*^9, 3.789485275349579*^9, 3.7894853110002804`*^9, 
   3.7894854709358225`*^9, 3.7894855364885335`*^9, {3.7894855853588967`*^9, 
   3.789485608811206*^9}, 3.7894904598303566`*^9, 3.789490534285358*^9, 
   3.789490625730544*^9, 3.7894922341031427`*^9, 3.7894931709007406`*^9, {
   3.789493378040408*^9, 3.789493397491413*^9}, 3.7894934958718615`*^9, 
   3.7894939126512084`*^9, {3.789494102667669*^9, 3.7894941271836243`*^9}, {
   3.789494195540311*^9, 3.789494219072407*^9}, {3.7894942749785423`*^9, 
   3.7894942997160854`*^9}, {3.7894944070395913`*^9, 
   3.7894944756112957`*^9}, {3.7894945189207296`*^9, 
   3.7894946102127247`*^9}, {3.789494677474505*^9, 3.789494712426075*^9}, {
   3.789495209590518*^9, 3.789495225292477*^9}, 3.7894952703121347`*^9, {
   3.7894966212023335`*^9, 3.789496649184561*^9}, {3.789496778014083*^9, 
   3.7894968166270046`*^9}, 3.7894968731263313`*^9, 3.789496970024977*^9, 
   3.789497153170344*^9, {3.789497187168468*^9, 3.7894972076977825`*^9}, {
   3.7894972523165894`*^9, 3.789497282218045*^9}, 3.789497430404339*^9, {
   3.7894976392988873`*^9, 3.7894976567332497`*^9}, 3.789497732427909*^9, 
   3.7894978281292906`*^9, {3.7894978880624514`*^9, 3.7894979231666126`*^9}, {
   3.789498055029708*^9, 3.789498060423326*^9}, {3.7894981068936653`*^9, 
   3.789498130513609*^9}, 3.789498183847043*^9, 3.7894983002211227`*^9, 
   3.789498359420486*^9, 3.7894984081192927`*^9, 3.789498454656912*^9, 
   3.78949851417595*^9, 3.7894985546547766`*^9, {3.7894986243631134`*^9, 
   3.7894986365475144`*^9}, 3.789498707696309*^9, {3.789498817311759*^9, 
   3.78949887937685*^9}, {3.7894989157306857`*^9, 3.7894989488563347`*^9}, 
   3.78949959543557*^9, 3.789499651358053*^9, {3.7895000370524263`*^9, 
   3.7895000617354183`*^9}, {3.789500131621604*^9, 3.7895001503028126`*^9}, 
   3.7895002467759542`*^9, 3.78950041636018*^9, 3.7895004706580205`*^9, 
   3.789500564019891*^9, {3.7895006796501026`*^9, 3.789500715765587*^9}, {
   3.7895007758250895`*^9, 3.789500801172366*^9}, {3.7895008434932504`*^9, 
   3.789500855342563*^9}, {3.7895008965674763`*^9, 3.7895009059815636`*^9}, 
   3.789500989664709*^9, 3.7895010753525925`*^9, 3.789501386155569*^9, 
   3.7895015430825*^9, 3.7895015868281593`*^9, 3.789501691914934*^9, 
   3.7895019761920567`*^9, 3.789502081500491*^9, {3.789502179076929*^9, 
   3.789502184720851*^9}, 3.789502253922039*^9, 3.789502334528346*^9, 
   3.7895023859393044`*^9, {3.7895024381897273`*^9, 3.789502452734846*^9}, {
   3.7895024983759413`*^9, 3.7895025056928444`*^9}, 3.7895025520177383`*^9, 
   3.7895654577697973`*^9, {3.789565590003736*^9, 3.7895656196066813`*^9}, 
   3.7895656952127757`*^9, 3.789565764445739*^9, 3.789565795148237*^9, 
   3.7895662955400195`*^9, {3.7895663321900344`*^9, 3.789566354673987*^9}, 
   3.7895664400741034`*^9, {3.7895668859528203`*^9, 3.7895669053758717`*^9}, 
   3.789567027314334*^9, 3.7895670726142406`*^9, 3.789567156594288*^9, 
   3.7895675343369684`*^9, {3.7895677449402776`*^9, 3.789567790755836*^9}, {
   3.789569109067383*^9, 3.7895691152084656`*^9}, {3.7895693287460155`*^9, 
   3.7895693471542606`*^9}, 3.7895694084308243`*^9, 3.789569516546026*^9, 
   3.78956966786119*^9, 3.789569749281086*^9, 3.7895700935597577`*^9, 
   3.789570213691089*^9, {3.7895703828738317`*^9, 3.7895704564463367`*^9}, 
   3.7895705061461735`*^9, 3.789570586311923*^9, 3.7895707810237856`*^9, 
   3.7895709156317854`*^9, 3.7895709527725887`*^9, 3.7895710235862894`*^9, 
   3.789571093426721*^9, 3.7895716281747684`*^9, 3.7895718446877356`*^9, 
   3.789571949068419*^9, 3.789572040852441*^9, 3.7895720804801855`*^9, 
   3.7895722213526883`*^9, {3.7895722598368464`*^9, 3.7895722738968554`*^9}, {
   3.7895723077812786`*^9, 3.7895723550249944`*^9}, 3.789572397757559*^9, {
   3.7895724485242643`*^9, 3.789572495301296*^9}, 3.7895739753966756`*^9, {
   3.789585224137389*^9, 3.7895852584646287`*^9}, 3.7895855390952673`*^9, {
   3.7895856371616645`*^9, 3.7895856530751247`*^9}, 3.789585693770663*^9, 
   3.789585727336935*^9, {3.7895862848477745`*^9, 3.7895863017625313`*^9}, {
   3.7895863416451406`*^9, 3.7895863658404655`*^9}, 3.7895864006155324`*^9, {
   3.7895864589048033`*^9, 3.7895864878015585`*^9}, 3.7895865326067886`*^9, 
   3.7895878580611596`*^9, 3.789587977191482*^9, 3.7895880221434536`*^9, 
   3.789588278461502*^9, 3.789588909879176*^9, 3.789659150074871*^9, 
   3.789674986638321*^9, 3.7896761261548247`*^9, {3.789676272953204*^9, 
   3.7896763016236258`*^9}, 3.7896769298926125`*^9, 3.7896775705015516`*^9, {
   3.7896777559875984`*^9, 3.789677783090682*^9}, 3.789678144815501*^9, 
   3.7896784357150016`*^9, 3.789678530175474*^9, {3.789678687305501*^9, 
   3.7896787150746255`*^9}, 3.789678762474948*^9, 3.7896788248731413`*^9, 
   3.7896789904847775`*^9, 3.7896796596390038`*^9, 3.7896797538868847`*^9, {
   3.789679936762141*^9, 3.789679984683292*^9}, 3.7896800363368473`*^9, 
   3.789680313194559*^9, 3.7896803889488616`*^9, 3.78968042022689*^9, 
   3.7896804589469123`*^9, {3.789680664259972*^9, 3.7896807001014047`*^9}, 
   3.789681245148409*^9, 3.789681319730275*^9, 3.7896814501585417`*^9, {
   3.7896815415165496`*^9, 3.7896815740497284`*^9}, 3.7896818137576675`*^9, 
   3.7896818780009413`*^9, 3.789681946192711*^9, 3.789682014370474*^9, 
   3.7897500911964183`*^9, 3.789750137370285*^9, 3.7897502256054225`*^9, {
   3.7897502625745974`*^9, 3.7897502847513185`*^9}, {3.789751988672135*^9, 
   3.7897520046895127`*^9}, 3.789753977528384*^9, {3.7897568023521442`*^9, 
   3.78975689433679*^9}, {3.7897612246482744`*^9, 3.7897612545057063`*^9}, 
   3.7897612939868975`*^9, 3.789762068947234*^9, 3.7897637919283066`*^9, 
   3.7897638450913076`*^9, 3.7897638853818607`*^9, {3.789764001045401*^9, 
   3.7897640289230213`*^9}, 3.7897640652565093`*^9, 3.7897640954450006`*^9, 
   3.789764265318297*^9, 3.78976434155147*^9, {3.7897643740374603`*^9, 
   3.7897643993132076`*^9}, {3.7897645073223786`*^9, 3.789764530525446*^9}, 
   3.789764567937182*^9, 3.7897660304356956`*^9, {3.789766324381794*^9, 
   3.7897663454576635`*^9}},ExpressionUUID->"451993ce-79a2-46ac-9986-\
ff08ae24219e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"complexInner", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Conjugate", "[", "a", "]"}], "}"}], ".", 
    RowBox[{"{", "a", "}"}]}]}], ";"}]], "Input",ExpressionUUID->"c8c71353-\
082e-48c3-a6df-10b7b274d581"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "variables", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Var", "=", 
     RowBox[{"{", 
      RowBox[{"A2", ",", "t", ",", "r", ",", "B2"}], "}"}]}], ";"}], "\n", 
   RowBox[{"(*", "solutions", "*)"}], "\n", 
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"eqns", ",", " ", "Var"}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "i_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Xi]", "[", "i", "]"}], 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", "s"}]}]], "Input",
 CellChangeTimes->{{3.7893165133089075`*^9, 3.7893166260894575`*^9}, {
   3.7893202901494064`*^9, 3.7893203013843718`*^9}, 3.7893208917492275`*^9, 
   3.78947545863046*^9, {3.7894755931332197`*^9, 3.7894756740914545`*^9}, {
   3.7894759295486593`*^9, 3.7894759359378257`*^9}, 3.7894759784212627`*^9, {
   3.7894761981447926`*^9, 3.7894762250964813`*^9}, {3.7894971430035486`*^9, 
   3.78949715153472*^9}, {3.7894971851428776`*^9, 3.7894972062057734`*^9}, 
   3.7894974234190392`*^9, 3.789497654663783*^9, 3.789497886418849*^9, {
   3.7894981767619886`*^9, 3.7894981983123484`*^9}, 3.78949851210349*^9, 
   3.7895000574169955`*^9, {3.789500141284872*^9, 3.7895001442370124`*^9}, {
   3.7895007563581195`*^9, 3.7895007709580636`*^9}, {3.7895008409500637`*^9, 
   3.789500853616209*^9}, {3.789500894551837*^9, 3.789501052094375*^9}, {
   3.789501272637676*^9, 3.789501365066448*^9}, {3.78950142240969*^9, 
   3.789501508598681*^9}, 3.789501573832303*^9, {3.789502197115714*^9, 
   3.789502222496011*^9}, {3.7895668700263615`*^9, 3.7895668942965183`*^9}, {
   3.7895670154560604`*^9, 3.7895670192099943`*^9}, 3.789567070274495*^9, {
   3.7896810731149063`*^9, 3.7896810976862144`*^9}, 3.7897639985692663`*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"936aebc0-3235-4148-a713-dbf310be5b10"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A2", "\[Rule]", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
         RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", "\[Epsilon]2", " ", 
       RowBox[{"\[Kappa]", "[", "1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]3", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"d", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]3", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"d", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]1", " ", "\[Epsilon]3", " ", 
           SuperscriptBox[
            RowBox[{"\[Kappa]", "[", "2", "]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]2", "2"], " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}], " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}]]}], ",", 
    RowBox[{"t", "\[Rule]", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Kappa]", "[", "1", "]"}], "-", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], ")"}]}]], " ", 
       "\[Epsilon]2", " ", "\[Epsilon]3", " ", 
       RowBox[{"\[Kappa]", "[", "1", "]"}], " ", 
       RowBox[{"\[Kappa]", "[", "2", "]"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]3", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], "-", 
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]3", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}]]}], ",", 
    RowBox[{"r", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "d", " ", 
         RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
            RowBox[{"\[Kappa]", "[", "2", "]"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]2", " ", 
             RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
            RowBox[{"\[Epsilon]1", " ", 
             RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]3", " ", 
             RowBox[{"\[Kappa]", "[", "2", "]"}]}], "-", 
            RowBox[{"\[Epsilon]2", " ", 
             RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]2", " ", 
             RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
            RowBox[{"\[Epsilon]1", " ", 
             RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]3", " ", 
             RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
            RowBox[{"\[Epsilon]2", " ", 
             RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]3"}], " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]3", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}]]}], ",", 
    RowBox[{"B2", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Kappa]", "[", "1", "]"}], "-", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], ")"}]}]], " ", 
       "\[Epsilon]2", " ", 
       RowBox[{"\[Kappa]", "[", "1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Epsilon]3"}], " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]3"}], " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
          RowBox[{"\[Epsilon]1", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]3", " ", 
           RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
          RowBox[{"\[Epsilon]2", " ", 
           RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7894755936937494`*^9, 3.7894756754029465`*^9}, 
   3.7894759375734763`*^9, 3.7894759788979883`*^9, {3.7894761990473967`*^9, 
   3.789476226622368*^9}, 3.7894766727239394`*^9, 3.7894775436674986`*^9, 
   3.789477717265145*^9, 3.7894777955977516`*^9, {3.7894779115724907`*^9, 
   3.789477927352309*^9}, {3.7894790541129503`*^9, 3.7894790779592066`*^9}, {
   3.7894791746960135`*^9, 3.7894792158968487`*^9}, {3.7894796462285147`*^9, 
   3.7894796700967445`*^9}, 3.789479782546215*^9, 3.789479871845373*^9, 
   3.789482673392068*^9, 3.7894829827354937`*^9, 3.7894834109897394`*^9, 
   3.7894835121795864`*^9, 3.7894840848480744`*^9, 3.789484159951932*^9, 
   3.789484575469551*^9, 3.789485037818226*^9, 3.7894851038955903`*^9, 
   3.7894851591604223`*^9, 3.789485202395897*^9, 3.789485275472251*^9, 
   3.7894853111209574`*^9, 3.7894854710584803`*^9, 3.789485536606219*^9, {
   3.7894855854696007`*^9, 3.789485608924914*^9}, 3.789490459983946*^9, 
   3.7894906258442383`*^9, 3.789492234209858*^9, 3.7894931710274005`*^9, {
   3.7894933781241846`*^9, 3.789493397596134*^9}, 3.789493495993536*^9, 
   3.789493912735997*^9, {3.789494102762415*^9, 3.789494127287347*^9}, {
   3.7894941956580076`*^9, 3.7894942191731367`*^9}, {3.7894942750752835`*^9, 
   3.789494299816829*^9}, {3.7894944071772227`*^9, 3.78949447571204*^9}, {
   3.7894945190194645`*^9, 3.7894946103463674`*^9}, {3.7894946775901957`*^9, 
   3.789494712548747*^9}, {3.7894952097052107`*^9, 3.7894952253981953`*^9}, 
   3.7894952704108696`*^9, {3.789496621369916*^9, 3.789496649303244*^9}, {
   3.789496778226487*^9, 3.7894968167227173`*^9}, 3.7894968732729106`*^9, 
   3.789496970162608*^9, 3.7894971532840705`*^9, {3.7894971872791986`*^9, 
   3.7894972078134737`*^9}, {3.789497252447233*^9, 3.7894972823527155`*^9}, {
   3.789497423827918*^9, 3.789497430437252*^9}, {3.7894976393278046`*^9, 
   3.789497656760209*^9}, 3.7894977324598255`*^9, 3.789497831457406*^9, {
   3.789497888093379*^9, 3.789497923199525*^9}, 3.7894980604512215`*^9, {
   3.789498106925576*^9, 3.7894981305454965`*^9}, {3.789498177389285*^9, 
   3.7894981996298256`*^9}, 3.789498300324812*^9, 3.7894983601365767`*^9, 
   3.7894984087955027`*^9, 3.7894984553460693`*^9, 3.789498514893033*^9, 
   3.7894985553529043`*^9, {3.7894986250732102`*^9, 3.7894986372546234`*^9}, 
   3.789498708373497*^9, {3.7894988180767145`*^9, 3.789498880086952*^9}, {
   3.7894989158224583`*^9, 3.7894989495774093`*^9}, 3.789499596151626*^9, 
   3.78949965203726*^9, {3.7895000377954226`*^9, 3.789500062111412*^9}, {
   3.7895001317153807`*^9, 3.7895001512792263`*^9}, 3.7895002468836656`*^9, 
   3.789500417272753*^9, 3.7895004715705795`*^9, 3.7895005649384065`*^9, 
   3.78950075857317*^9, 3.7895008015882807`*^9, {3.7895008445245037`*^9, 
   3.789500856444791*^9}, {3.789500897689477*^9, 3.789500906998866*^9}, {
   3.789500979091971*^9, 3.7895010754263716`*^9}, 3.7895013871369457`*^9, {
   3.7895014183405485`*^9, 3.789501509222041*^9}, {3.7895015442244473`*^9, 
   3.789501587988061*^9}, 3.789501693099767*^9, 3.7895019772612233`*^9, 
   3.7895020825925703`*^9, {3.789502191851781*^9, 3.7895022231292863`*^9}, 
   3.789502254730877*^9, 3.789502335373087*^9, 3.7895023867242002`*^9, {
   3.7895024389905567`*^9, 3.789502453536705*^9}, {3.7895024991727767`*^9, 
   3.7895025064657564`*^9}, 3.7895025528415103`*^9, 3.7895654588518753`*^9, {
   3.789565590697833*^9, 3.7895656202908525`*^9}, 3.789565695920915*^9, 
   3.7895657651408815`*^9, 3.789565795821471*^9, 3.789566296235161*^9, {
   3.7895663328832006`*^9, 3.789566355378104*^9}, 3.789566440819112*^9, {
   3.7895668866828413`*^9, 3.789566906375245*^9}, 3.789567029058697*^9, 
   3.789567073629527*^9, 3.789567157610543*^9, 3.789567535359236*^9, {
   3.789567745508758*^9, 3.78956779168536*^9}, {3.789569110057268*^9, 
   3.789569116179901*^9}, {3.7895693296884956`*^9, 3.789569348146587*^9}, 
   3.789569409392257*^9, 3.789569517510475*^9, 3.7895696688325934`*^9, 
   3.789569750256482*^9, 3.7895700945620785`*^9, 3.7895702146794467`*^9, {
   3.789570383903048*^9, 3.789570457420735*^9}, 3.7895705071255293`*^9, 
   3.7895705873272085`*^9, 3.7895707819851766`*^9, 3.7895709166290846`*^9, 
   3.789570952905229*^9, 3.7895710245058327`*^9, 3.7895710943802004`*^9, 
   3.789571629265849*^9, 3.7895718454337015`*^9, 3.7895719498393545`*^9, 
   3.7895720416104546`*^9, 3.789572081633072*^9, 3.7895722223839655`*^9, {
   3.7895722608356085`*^9, 3.7895722750048943`*^9}, {3.789572308784605*^9, 
   3.789572356018343*^9}, 3.789572398759899*^9, {3.7895724495365906`*^9, 
   3.78957249629963*^9}, 3.7895739763960104`*^9, {3.78958522519556*^9, 
   3.78958525929644*^9}, 3.7895855399220886`*^9, {3.7895856379874563`*^9, 
   3.7895856539069014`*^9}, 3.7895856946054296`*^9, 3.789585728145773*^9, {
   3.7895862856875296`*^9, 3.7895863026282454`*^9}, {3.789586342458965*^9, 
   3.7895863667061496`*^9}, 3.7895864014492903`*^9, {3.7895864597645454`*^9, 
   3.789586488658268*^9}, 3.7895865334884324`*^9, 3.7895878589767556`*^9, 
   3.78958797820677*^9, 3.7895880230330753`*^9, 3.7895882793920155`*^9, 
   3.789588910759822*^9, 3.78965915177297*^9, 3.7896749879047003`*^9, 
   3.789676127702528*^9, {3.7896762744715204`*^9, 3.789676303422803*^9}, 
   3.7896769311664257`*^9, 3.789677572076597*^9, {3.7896777573960814`*^9, 
   3.789677784407237*^9}, 3.789678146373269*^9, 3.7896784373695016`*^9, 
   3.789678531695709*^9, {3.7896786891310334`*^9, 3.7896787164889975`*^9}, 
   3.789678764190647*^9, 3.7896788264157667`*^9, 3.7896789921594944`*^9, 
   3.789679660924292*^9, 3.789679755455347*^9, {3.7896799382932167`*^9, 
   3.789679986287113*^9}, 3.789680037668434*^9, 3.789680314547276*^9, 
   3.789680390523662*^9, 3.7896804219209166`*^9, 3.789680461014616*^9, {
   3.789680665893665*^9, 3.7896807018457375`*^9}, 3.789681246908586*^9, 
   3.7896813213437405`*^9, 3.7896814516763086`*^9, {3.7896815431348667`*^9, 
   3.7896815757368665`*^9}, 3.7896818154309955`*^9, 3.7896818792832212`*^9, 
   3.7896819481121454`*^9, 3.789682016255904*^9, 3.7897500923114676`*^9, 
   3.7897501384404244`*^9, 3.7897502267413855`*^9, {3.789750263618807*^9, 
   3.789750285863345*^9}, {3.7897519897354784`*^9, 3.789752005752671*^9}, 
   3.789753978786024*^9, {3.789756803599805*^9, 3.7897568954996815`*^9}, 
   3.789761225291526*^9, 3.7897612566790085`*^9, 3.7897612958114715`*^9, 
   3.7897620707258835`*^9, 3.789763793710312*^9, 3.7897638459911394`*^9, 
   3.7897638869596233`*^9, {3.789764002350351*^9, 3.789764030272472*^9}, 
   3.7897640666565924`*^9, 3.789764096803274*^9, 3.789764266804267*^9, 
   3.789764342803771*^9, {3.7897643752402935`*^9, 3.7897644006320143`*^9}, {
   3.7897645087567286`*^9, 3.7897645318318524`*^9}, 3.78976456924306*^9, 
   3.789766031725627*^9, {3.7897663257721186`*^9, 
   3.789766346928939*^9}},ExpressionUUID->"f4162ff6-67c3-4046-85cf-\
e25efb3469af"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.7895019735132055`*^9, 3.7895020792395363`*^9, 3.7895023829189157`*^9, {
   3.7895654293008776`*^9, 3.7895654385910416`*^9}, 3.789567527387516*^9, 
   3.7895677632303867`*^9, 3.7895692327844276`*^9, 3.789570504021826*^9, 
   3.7895705787191505`*^9, 3.789674970785945*^9, 3.7896803089486933`*^9, {
   3.7896803673614044`*^9, 3.789680372549023*^9}, 
   3.789680405475668*^9},ExpressionUUID->"7f8e6a72-a216-41f6-ba1e-\
2d7d634b5d7f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7895703893016453`*^9, 3.7895704319930706`*^9}, 
   3.7895705021348677`*^9, 
   3.789570774104244*^9},ExpressionUUID->"7766d2b2-e38a-4000-8337-\
21eaff6ac279"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "solution", " ", "from", " ", "solving", " ", "Maxwell", " ", "BCs"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Rcoeffr", "=", 
    RowBox[{
     RowBox[{"r", "/.", "s"}], "//", "FullSimplify"}]}], 
   RowBox[{"(*", " ", "reflectioncoefficient", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Reflectancesq", "=", 
     RowBox[{
      RowBox[{"complexInner", "[", 
       RowBox[{"Rcoeffr", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "s"}]}], 
    RowBox[{"(*", 
     SuperscriptBox["r", "2"], "*)"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7895001569101486`*^9, 3.789500209422805*^9}, {
   3.78950030496688*^9, 3.789500310391406*^9}, {3.7895003837832484`*^9, 
   3.789500405515197*^9}, {3.78950046085924*^9, 3.7895004856968603`*^9}, 
   3.7895010873829794`*^9, 3.7895013748533*^9, {3.7895022941664596`*^9, 
   3.7895022990860863`*^9}, {3.7895024343250713`*^9, 
   3.7895024360633855`*^9}, {3.7895024963751893`*^9, 
   3.7895025037674947`*^9}, {3.789502547457924*^9, 3.789502549616151*^9}, {
   3.7895655601304827`*^9, 3.789565572795627*^9}, 3.789565688900672*^9, {
   3.789565761331061*^9, 3.789565787403762*^9}, {3.7895699288990164`*^9, 
   3.789569933332165*^9}, {3.789570021015252*^9, 3.789570025803879*^9}, {
   3.789570061430667*^9, 3.789570068691265*^9}, 3.7895701058204556`*^9, {
   3.789570171639536*^9, 3.789570174244535*^9}, {3.7895708870890493`*^9, 
   3.7895709225846963`*^9}, 3.7895720780696287`*^9, {3.789572394753596*^9, 
   3.789572407432027*^9}, {3.7896804364050136`*^9, 3.7896804449227223`*^9}, {
   3.789680522914076*^9, 3.7896805568028364`*^9}, {3.789681263598798*^9, 
   3.7896812968322315`*^9}, {3.78968138382801*^9, 3.7896814197071886`*^9}, {
   3.7897502220160227`*^9, 3.7897502234112873`*^9}, {3.78975025922655*^9, 
   3.7897502606916313`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5542f762-54ee-4e90-8621-2d724dd37bdb"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "d", " ", 
      RowBox[{"\[Kappa]", "[", "1", "]"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]2", " ", 
          RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
         RowBox[{"\[Epsilon]1", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]3", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}], "-", 
         RowBox[{"\[Epsilon]2", " ", 
          RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]2", " ", 
          RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
         RowBox[{"\[Epsilon]1", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]3", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}]]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]2", " ", 
        RowBox[{"\[Kappa]", "[", "1", "]"}]}], "-", 
       RowBox[{"\[Epsilon]1", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Epsilon]3"}], " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
       RowBox[{"\[Epsilon]2", " ", 
        RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]2", " ", 
        RowBox[{"\[Kappa]", "[", "1", "]"}]}], "+", 
       RowBox[{"\[Epsilon]1", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]3", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}]}], "+", 
       RowBox[{"\[Epsilon]2", " ", 
        RowBox[{"\[Kappa]", "[", "3", "]"}]}]}], ")"}]}]}]], "}"}]], "Output",
 CellChangeTimes->{{3.7896806663974476`*^9, 3.7896807021448927`*^9}, 
   3.789681247357031*^9, {3.7896813153367605`*^9, 3.789681321960893*^9}, {
   3.789681446214979*^9, 3.7896814520591946`*^9}, {3.789681543759663*^9, 
   3.789681576341091*^9}, 3.7896818157549777`*^9, 3.789681879503536*^9, 
   3.7896819485714493`*^9, 3.789682016664513*^9, 3.7897500924769955`*^9, 
   3.789750138599002*^9, 3.7897502268969817`*^9, {3.7897502637753887`*^9, 
   3.789750286039873*^9}, {3.789751989896082*^9, 3.789752005915236*^9}, 
   3.7897539788827925`*^9, {3.7897568037833138`*^9, 3.7897568956523004`*^9}, 
   3.7897612253852544`*^9, 3.7897612568040104`*^9, 3.7897612959272966`*^9, 
   3.789762070850822*^9, 3.789763793850874*^9, 3.789763846131728*^9, 
   3.789763887087572*^9, {3.789764002553428*^9, 3.789764030488093*^9}, 
   3.789764066838109*^9, 3.7897640969750843`*^9, 3.7897642669788923`*^9, 
   3.789764342975608*^9, {3.789764375396478*^9, 3.789764400819497*^9}, {
   3.789764508944191*^9, 3.789764532015362*^9}, 3.7897645694325266`*^9, 
   3.78976603192872*^9, {3.789766325959548*^9, 
   3.7897663471189723`*^9}},ExpressionUUID->"a8c91b3b-a95c-40b6-b648-\
dc690e1df893"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"noginov", " ", "Solution"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Rcoeffrnoi", "=", 
     FractionBox[
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}], "d"}]]}]}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"r", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          RowBox[{"\[Kappa]", "[", "2", "]"}], "d"}]]}]}]]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"\[Kappa]", "[", "i", "]"}], 
       RowBox[{"\[Epsilon]", "[", "j", "]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Kappa]", "[", "j", "]"}], 
       RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"\[Kappa]", "[", "i", "]"}], 
       RowBox[{"\[Epsilon]", "[", "j", "]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Kappa]", "[", "j", "]"}], 
       RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}]]}], " ", "\n", 
   RowBox[{
    RowBox[{"ReflectancesqNonigov", "=", 
     RowBox[{"complexInner", "[", "Rcoeffrnoi", "]"}]}], ";"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.789569892679802*^9, 3.789569904266855*^9}, 
   3.7895699551299467`*^9, {3.789570041308431*^9, 3.789570081846074*^9}, {
   3.789570122952648*^9, 3.789570131349209*^9}, {3.7895702326930285`*^9, 
   3.7895702369247155`*^9}, {3.7895718147985077`*^9, 3.789571822445152*^9}, {
   3.7895719382718315`*^9, 3.7895719439191523`*^9}, {3.7895719817280865`*^9, 
   3.789572024874985*^9}, 3.789572074325607*^9, 3.789572378456481*^9, {
   3.7896750172140546`*^9, 3.7896750182925186`*^9}, 3.7896804928654146`*^9, {
   3.789681139020075*^9, 3.789681197669721*^9}, {3.789681503606419*^9, 
   3.7896815383967943`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"b920a2e1-2f68-44a8-8be8-fb2539986ca2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Rcoeffr", "-", "Rcoeffrnoi"}], ")"}], "//", "FullSimplify"}], 
  RowBox[{"(*", 
   RowBox[{
   "comparision", " ", "of", " ", "our", " ", "solution", " ", "to", " ", 
    RowBox[{"nonigov", "'"}], "s"}], "*)"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7895877690750313`*^9, 3.789587830164733*^9}, {
   3.789587959076135*^9, 3.7895879688659663`*^9}, {3.789588008754134*^9, 
   3.789588010530363*^9}, {3.7895888917626047`*^9, 3.789588907931416*^9}, 
   3.7896762922337413`*^9, 3.7896802992213163`*^9, 3.789680332080348*^9, 
   3.7896804769027*^9, {3.7896811409477816`*^9, 3.7896811692950087`*^9}, 
   3.7896812015325003`*^9, {3.789681332205595*^9, 3.789681333631034*^9}, {
   3.7896814246746387`*^9, 3.789681493009354*^9}, {3.789681553384203*^9, 
   3.7896815852953978`*^9}, 
   3.7897645050374527`*^9},ExpressionUUID->"5754e6e7-0091-4746-a172-\
358a2b93bea5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Kappa]", "[", "index_", "]"}], ":=", " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["k0", "2"], 
     RowBox[{"\[Epsilon]", "[", "index", "]"}], 
     RowBox[{"\[Mu]", "[", "index", "]"}]}], "-", 
    SuperscriptBox["k", "2"]}], " ", "]"}], 
  RowBox[{"(*", 
   RowBox[{"helmholtz", " ", "equation"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7896806591169953`*^9, 
  3.7896806871954556`*^9}},ExpressionUUID->"2ee1fa2e-d824-4699-b054-\
a57ad1a5731b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Refc", "[", "d_", "]"}], "=", 
  RowBox[{"Reflectancesq", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Refc1", "[", "d_", "]"}], "=", 
   RowBox[{"ReflectancesqNonigov", "/.", "params"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7897663209444203`*^9, 
  3.789766342586149*^9}},ExpressionUUID->"7d8233d3-60bc-4e26-a193-\
1d27edd44de0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "d", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["k", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"d", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]]}], "]"}]}]}]], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "+", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]], " ", 
          "\[Epsilon]3"}], "-", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "-", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]], " ", 
          "\[Epsilon]3"}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], 
        ")"}]}]}], ")"}], " ", 
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "+", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]], " ", 
          "\[Epsilon]3"}], "-", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "-", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]], " ", 
          "\[Epsilon]3"}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], 
        ")"}]}]}], "]"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "-", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["k", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}], " ", 
          "\[Epsilon]3"}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "+", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]], " ", 
          "\[Epsilon]3"}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], 
        ")"}]}]}], ")"}], " ", 
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "d", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "-", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SqrtBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["k", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}], " ", 
          "\[Epsilon]3"}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]1"}]}]], " ", 
          "\[Epsilon]2"}], "+", 
         RowBox[{"\[Epsilon]1", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]]}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]2"}]}]], " ", 
          "\[Epsilon]3"}], "+", 
         RowBox[{"\[Epsilon]2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k0", "2"], " ", "\[Epsilon]3"}]}]]}]}], 
        ")"}]}]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7897663261470046`*^9, 
  3.7897663472126675`*^9}},ExpressionUUID->"df8713f9-4072-4d05-9234-\
2cad07a1c325"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", "29979245800."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]p", "=", 
   RowBox[{"(*", 
    RowBox[{"9.6", " ", 
     RowBox[{"eV", "/", "hbar"}]}], "*)"}], 
   RowBox[{"9.6", " ", 
    RowBox[{"eV", "/", "hbar"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   RowBox[{"(*", 
    RowBox[{"1.5", " ", 
     RowBox[{"eV", "/", "hbar"}]}], "*)"}], 
   RowBox[{"1.5", " ", 
    RowBox[{"eV", "/", "hbar"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", " ", 
   RowBox[{"(", 
    RowBox[{"\[Omega]", "/", "c"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", "=", 
   RowBox[{"25", " ", "nm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], ")"}], " ", "k0", "  ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "/.", "params"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.789477401950921*^9, 3.789477406199567*^9}, {
   3.7894774537025824`*^9, 3.7894774994856033`*^9}, {3.7894775571744256`*^9, 
   3.789477595542988*^9}, {3.789477722766443*^9, 3.7894777243661633`*^9}, {
   3.789477758154874*^9, 3.789477761849966*^9}, {3.7894779378313475`*^9, 
   3.789477944464617*^9}, {3.789477994518054*^9, 3.789477995656032*^9}, {
   3.789478035634969*^9, 3.7894780475691056`*^9}, {3.789478693529589*^9, 
   3.7894787787658997`*^9}, {3.789478868726429*^9, 3.7894788827509637`*^9}, {
   3.7894790521781273`*^9, 3.789479075942598*^9}, {3.7894791842335215`*^9, 
   3.7894792141475253`*^9}, {3.7894792541626563`*^9, 3.789479291591442*^9}, {
   3.7894793838938675`*^9, 3.789479474838873*^9}, 3.7894797801725616`*^9, 
   3.7894841699601784`*^9, {3.789484511591258*^9, 3.789484515636444*^9}, {
   3.7894850993697224`*^9, 3.789485101541915*^9}, {3.789485141108677*^9, 
   3.7894851570411267`*^9}, {3.7894851955621166`*^9, 3.789485200363282*^9}, {
   3.789485262078093*^9, 3.7894852737169724`*^9}, 3.789485332814996*^9, {
   3.7894853659802494`*^9, 3.789485370355526*^9}, {3.7894854228603487`*^9, 
   3.7894854317575645`*^9}, 3.789485467796215*^9, {3.789485575292834*^9, 
   3.7894856074069643`*^9}, 3.789493375791421*^9, 3.789493938269726*^9, {
   3.7895677367631655`*^9, 3.789567742047012*^9}, 3.789569617584444*^9, {
   3.789585213125611*^9, 3.78958525634931*^9}, {3.7895857065136013`*^9, 
   3.7895857155893393`*^9}, {3.789586271320964*^9, 3.7895862990876827`*^9}, {
   3.7895863359633303`*^9, 3.7895863633830338`*^9}, {3.7895863988771563`*^9, 
   3.7895864261702332`*^9}, {3.789586973747142*^9, 3.78958697526703*^9}, 
   3.789587890986184*^9, {3.789676123134763*^9, 3.789676186517232*^9}, {
   3.7896766139573355`*^9, 3.789676642627425*^9}, {3.7896769013128843`*^9, 
   3.789676904059719*^9}, {3.7896769938636866`*^9, 3.7896770072038116`*^9}, {
   3.7896774404486427`*^9, 3.7896774411460724`*^9}, {3.7896775434858885`*^9, 
   3.789677549856535*^9}, {3.789677705523329*^9, 3.78967770775666*^9}, {
   3.789677979736919*^9, 3.7896779943704557`*^9}, {3.7896780638756742`*^9, 
   3.789678104862694*^9}, {3.789678139374232*^9, 3.789678171328372*^9}, {
   3.789678283032503*^9, 3.7896783114355125`*^9}, {3.789678343384829*^9, 
   3.789678365825837*^9}, {3.7896783989413915`*^9, 3.789678432406017*^9}, {
   3.7896784801957088`*^9, 3.789678513746295*^9}, {3.7896785521423492`*^9, 
   3.789678565744733*^9}, {3.789678602332073*^9, 3.789678603200306*^9}, {
   3.7896786457771244`*^9, 3.789678821667804*^9}, {3.7896788654491615`*^9, 
   3.789678920268179*^9}, {3.78967917774392*^9, 3.789679187575555*^9}, {
   3.7896794538279448`*^9, 3.7896794629102373`*^9}, {3.789679599101529*^9, 
   3.7896796794727316`*^9}, {3.7896797186492467`*^9, 3.789679750904331*^9}, {
   3.7896797867903347`*^9, 3.789679788282202*^9}, {3.789679880990659*^9, 
   3.7896799489726095`*^9}, 3.789679981874181*^9, {3.7896800245292034`*^9, 
   3.78968004728113*^9}, 3.7897642593858795`*^9, {3.7897645872747602`*^9, 
   3.7897645875403223`*^9}},ExpressionUUID->"5eefb8e5-b6e8-4ea3-8c2b-\
5cea579bad6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Plotting", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Tab1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", " ", 
           RowBox[{"180", "/", "\[Pi]"}]}], ",", 
          RowBox[{
           RowBox[{"Refc", "[", "d", "]"}], "/.", "params"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", 
          RowBox[{"1", "/", "100"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"50", "nm"}], ",", 
        RowBox[{"70", "nm"}], " ", ",", 
        RowBox[{"10", "nm"}]}], "}"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.789477401950921*^9, 3.789477406199567*^9}, {
   3.7894774537025824`*^9, 3.7894774994856033`*^9}, {3.7894775571744256`*^9, 
   3.789477595542988*^9}, {3.789477722766443*^9, 3.7894777243661633`*^9}, {
   3.789477758154874*^9, 3.789477761849966*^9}, {3.7894779378313475`*^9, 
   3.789477944464617*^9}, {3.789477994518054*^9, 3.789477995656032*^9}, {
   3.789478035634969*^9, 3.7894780475691056`*^9}, {3.789478693529589*^9, 
   3.7894787787658997`*^9}, {3.789478868726429*^9, 3.7894788827509637`*^9}, {
   3.7894790521781273`*^9, 3.789479075942598*^9}, {3.7894791842335215`*^9, 
   3.7894792141475253`*^9}, {3.7894792541626563`*^9, 3.789479291591442*^9}, {
   3.7894793838938675`*^9, 3.789479474838873*^9}, 3.7894797801725616`*^9, 
   3.7894841699601784`*^9, {3.789484511591258*^9, 3.789484515636444*^9}, {
   3.7894850993697224`*^9, 3.789485101541915*^9}, {3.789485141108677*^9, 
   3.7894851570411267`*^9}, {3.7894851955621166`*^9, 3.789485200363282*^9}, {
   3.789485262078093*^9, 3.7894852737169724`*^9}, {3.789485332814996*^9, 
   3.789485337689744*^9}, {3.789493926882167*^9, 3.7894939275713263`*^9}, {
   3.7894941929601984`*^9, 3.7894942168194685`*^9}, 3.789494326630141*^9, {
   3.7894944709926424`*^9, 3.78949447339921*^9}, {3.789494580217904*^9, 
   3.7894945889844427`*^9}, 3.78949666233071*^9, {3.7894968703646536`*^9, 
   3.789496871763915*^9}, {3.789498375954292*^9, 3.789498378954243*^9}, 
   3.7894984223672323`*^9, {3.789498550188684*^9, 3.7894985534759283`*^9}, {
   3.7894985849304943`*^9, 3.789498634229712*^9}, 3.7894988513098927`*^9, 
   3.7894995902075243`*^9, {3.7895002702207594`*^9, 3.7895002838553123`*^9}, {
   3.789501098175332*^9, 3.7895011108235493`*^9}, {3.789501713481867*^9, 
   3.78950172926168*^9}, {3.789566266560984*^9, 3.7895662801486616`*^9}, {
   3.789569304051057*^9, 3.7895693156360617`*^9}, 3.7895697350984645`*^9, {
   3.7895701644637117`*^9, 3.789570196036316*^9}, {3.78957024036356*^9, 
   3.7895702502181864`*^9}, {3.7895708359049006`*^9, 
   3.7895708518622327`*^9}, {3.789570979296686*^9, 3.78957100291455*^9}, {
   3.7895711491948614`*^9, 3.7895711494102473`*^9}, {3.78957219777044*^9, 
   3.7895721982671156`*^9}, 3.789572253314285*^9, 3.789572461521557*^9, {
   3.7895864390208497`*^9, 3.789586439847673*^9}, {3.7895865716893177`*^9, 
   3.7895865758083086`*^9}, {3.789586656894555*^9, 3.7895867406576653`*^9}, {
   3.7895868062428226`*^9, 3.7895868116573496`*^9}, {3.789586864331545*^9, 
   3.7895868673704205`*^9}, {3.7895869881565742`*^9, 3.78958703800832*^9}, 
   3.7896762048098936`*^9, 3.7896785260159273`*^9, 3.7896786138848352`*^9, {
   3.7896789346352186`*^9, 3.789678976098938*^9}, {3.7896816495492*^9, 
   3.789681669651354*^9}, {3.7896817557012153`*^9, 3.7896817976629148`*^9}, {
   3.789681828553178*^9, 3.789681829724798*^9}, {3.789681861989745*^9, 
   3.7896819205335474`*^9}, {3.7896819771871147`*^9, 
   3.7896820017114596`*^9}, {3.7897501116577244`*^9, 3.7897501353374524`*^9}, 
   3.789750244257561*^9, 3.7897502753973274`*^9, {3.7897541098404303`*^9, 
   3.7897541243853703`*^9}, {3.7897568133427663`*^9, 3.789756892529152*^9}, {
   3.7897640264277754`*^9, 3.789764092974927*^9}, {3.7897642550532804`*^9, 
   3.789764339864585*^9}, {3.789766363459883*^9, 
   3.7897663659749527`*^9}},ExpressionUUID->"25e06368-d8ab-46b4-bc97-\
7253060027ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tab2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]", " ", 
         RowBox[{"180", "/", "\[Pi]"}]}], " ", ",", 
        RowBox[{"Refc1", "[", 
         RowBox[{"70", "nm"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"1", "/", "100"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.789477401950921*^9, 3.789477406199567*^9}, {
   3.7894774537025824`*^9, 3.7894774994856033`*^9}, {3.7894775571744256`*^9, 
   3.789477595542988*^9}, {3.789477722766443*^9, 3.7894777243661633`*^9}, {
   3.789477758154874*^9, 3.789477761849966*^9}, {3.7894779378313475`*^9, 
   3.789477944464617*^9}, {3.789477994518054*^9, 3.789477995656032*^9}, {
   3.789478035634969*^9, 3.7894780475691056`*^9}, {3.789478693529589*^9, 
   3.7894787787658997`*^9}, {3.789478868726429*^9, 3.7894788827509637`*^9}, {
   3.7894790521781273`*^9, 3.789479075942598*^9}, {3.7894791842335215`*^9, 
   3.7894792141475253`*^9}, {3.7894792541626563`*^9, 3.789479291591442*^9}, {
   3.7894793838938675`*^9, 3.789479474838873*^9}, 3.7894797801725616`*^9, 
   3.7894841699601784`*^9, {3.789484511591258*^9, 3.789484515636444*^9}, {
   3.7894850993697224`*^9, 3.789485101541915*^9}, {3.789485141108677*^9, 
   3.7894851570411267`*^9}, {3.7894851955621166`*^9, 3.789485200363282*^9}, {
   3.789485262078093*^9, 3.7894852737169724`*^9}, {3.789485332814996*^9, 
   3.789485337689744*^9}, {3.789493926882167*^9, 3.7894939275713263`*^9}, {
   3.7894941929601984`*^9, 3.7894942168194685`*^9}, 3.789494326630141*^9, {
   3.7894944709926424`*^9, 3.78949447339921*^9}, {3.789494580217904*^9, 
   3.7894945889844427`*^9}, 3.78949666233071*^9, {3.7894968703646536`*^9, 
   3.789496871763915*^9}, {3.789498375954292*^9, 3.789498378954243*^9}, 
   3.7894984223672323`*^9, {3.789498550188684*^9, 3.7894985534759283`*^9}, {
   3.7894985849304943`*^9, 3.789498634229712*^9}, 3.7894988513098927`*^9, 
   3.7894995902075243`*^9, {3.7895002702207594`*^9, 3.7895002838553123`*^9}, {
   3.789501098175332*^9, 3.7895011108235493`*^9}, {3.789501713481867*^9, 
   3.78950172926168*^9}, {3.789566266560984*^9, 3.7895662801486616`*^9}, {
   3.789569304051057*^9, 3.7895693156360617`*^9}, 3.7895697350984645`*^9, {
   3.7895701644637117`*^9, 3.789570196036316*^9}, {3.78957024036356*^9, 
   3.7895702502181864`*^9}, {3.7895708359049006`*^9, 
   3.7895708518622327`*^9}, {3.789570979296686*^9, 3.78957100291455*^9}, {
   3.7895711491948614`*^9, 3.7895711494102473`*^9}, {3.78957219777044*^9, 
   3.7895721982671156`*^9}, 3.789572253314285*^9, 3.789572461521557*^9, {
   3.7895864390208497`*^9, 3.789586439847673*^9}, {3.7895865716893177`*^9, 
   3.7895865758083086`*^9}, {3.789586656894555*^9, 3.7895867406576653`*^9}, {
   3.7895868062428226`*^9, 3.7895868116573496`*^9}, {3.789586864331545*^9, 
   3.7895868673704205`*^9}, {3.7895869881565742`*^9, 3.78958703800832*^9}, 
   3.7896762048098936`*^9, 3.7896785260159273`*^9, 3.7896786138848352`*^9, {
   3.7896789346352186`*^9, 3.789678976098938*^9}, {3.7896816495492*^9, 
   3.789681669651354*^9}, {3.7896817557012153`*^9, 3.7896817976629148`*^9}, {
   3.789681828553178*^9, 3.789681829724798*^9}, {3.789681861989745*^9, 
   3.789681909078389*^9}, {3.789764371959918*^9, 
   3.789764395475524*^9}},ExpressionUUID->"29a72f81-b8d0-42f6-b3ff-\
6b0ff5491812"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Tab1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]\>\"", ",", "\"\<|R|\>\""}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "0.85"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"LineLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<d= 50nm\>\"", ",", "\"\<d= 60nm\>\"", ",", "\"\<d= 70nm\>\""}],
           "}"}], ",", 
         RowBox[{"LegendMarkers", "\[Rule]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.1", "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"9", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
           "]"}]}]}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"{", 
         RowBox[{"Right", ",", "Bottom"}], "}"}], "*)"}], 
       RowBox[{"{", 
        RowBox[{".33", ",", ".4"}], "}"}]}], "]"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"Thickness", "\[Rule]", "0.005"}]}], "}"}], 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"Thickness", "\[Rule]", "0.005"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Thickness", "\[Rule]", "0.005"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", "Black", "]"}], ",", 
        RowBox[{"Thickness", "\[Rule]", "0.004"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", "Black", "]"}], ",", 
        RowBox[{"Thickness", "\[Rule]", "0.004"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"FontSize", "\[Rule]", "18"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7894850460641813`*^9, 3.7894850924811025`*^9}, {
   3.7894856494203577`*^9, 3.789485679193731*^9}, {3.789494360002725*^9, 
   3.789494363975136*^9}, {3.789498462598851*^9, 3.7894984991959953`*^9}, 
   3.789498666709888*^9, {3.7894987143285875`*^9, 3.7894987553180113`*^9}, 
   3.7894988580598345`*^9, 3.7894989017381067`*^9, {3.7894996303881073`*^9, 
   3.789499634254773*^9}, {3.789500339160511*^9, 3.7895003616832685`*^9}, {
   3.7895005236817255`*^9, 3.7895005372235003`*^9}, {3.7895019526808953`*^9, 
   3.789501952864403*^9}, 3.789502017114533*^9, 3.789502618177925*^9, {
   3.7895654679456024`*^9, 3.7895654707919593`*^9}, {3.789565640655467*^9, 
   3.789565643991517*^9}, 3.7895662910485644`*^9, 3.789566338739605*^9, 
   3.7895670793392925`*^9, {3.789567800322261*^9, 3.7895678227716227`*^9}, 
   3.7895694181667695`*^9, {3.789569679088152*^9, 3.789569685888012*^9}, {
   3.7895697640007277`*^9, 3.7895698081088085`*^9}, {3.7895702225541697`*^9, 
   3.78957022582043*^9}, {3.7895703493961897`*^9, 3.789570355158782*^9}, {
   3.7895704146693425`*^9, 3.7895704183884263`*^9}, {3.78957052033422*^9, 
   3.7895705251912384`*^9}, {3.789570789864226*^9, 3.78957078997991*^9}, {
   3.7895710162240076`*^9, 3.789571028929017*^9}, 3.789572064312377*^9, {
   3.7895722311614914`*^9, 3.789572234916474*^9}, 3.789572335365517*^9, 
   3.7895724561519065`*^9, {3.789572512283638*^9, 3.789572518159893*^9}, {
   3.7896801215482035`*^9, 3.789680149829108*^9}, {3.789680211252269*^9, 
   3.789680211395876*^9}, {3.789681690202874*^9, 3.7896817450078545`*^9}, {
   3.789764243224983*^9, 3.7897642490248795`*^9}, {3.7897645602193513`*^9, 
   3.7897645649437113`*^9}, {3.7897660225936356`*^9, 3.789766061895584*^9}, {
   3.7897661015850506`*^9, 
   3.7897662604247513`*^9}},ExpressionUUID->"fdb14cee-9857-4e99-84e1-\
74da7d6f28dd"],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, {{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.011111111111111112`], AbsoluteThickness[1.6], 
       StyleBox[LineBox[CompressedData["
1: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
         "]],
        FontSize->18]}, 
      {RGBColor[1, 0, 0], PointSize[0.011111111111111112`], Thickness[0.005], 
       StyleBox[LineBox[CompressedData["
1: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
         "]],
        FontSize->18]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       0.011111111111111112`], AbsoluteThickness[1.6], 
       StyleBox[LineBox[CompressedData["
1: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
aOxbjFYiD9wuyoxqfpWg/wFstail
         "]],
        FontSize->18]}}, {}, {}, {}, {}}, InsetBox[
     TemplateBox[{"\"d= 50nm\"", "\"d= 60nm\"", "\"d= 70nm\""},
      "LineLegend",
      DisplayFunction->(FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6], FontSize -> 18], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6], FontSize -> 18], {
                    InsetBox[
                    GraphicsBox[{
                    Thickness[0.1], 
                    LineBox[{{1, 0}, {9, 0}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6], FontSize -> 18]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {20, 10},
                     PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    AbsoluteThickness[1.6], FontSize -> 18, 
                    RGBColor[1, 0, 0], Thickness -> 0.005], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    AbsoluteThickness[1.6], FontSize -> 18, 
                    RGBColor[1, 0, 0], Thickness -> 0.005], {
                    InsetBox[
                    GraphicsBox[{
                    Thickness[0.1], 
                    LineBox[{{1, 0}, {9, 0}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    AbsoluteThickness[1.6], FontSize -> 18, 
                    RGBColor[1, 0, 0], Thickness -> 0.005]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {20, 10},
                     PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6], FontSize -> 18], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6], FontSize -> 18], {
                    InsetBox[
                    GraphicsBox[{
                    Thickness[0.1], 
                    LineBox[{{1, 0}, {9, 0}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6], FontSize -> 18]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {20, 10},
                     PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.011111111111111112`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.011111111111111112`", "]"}], 
                   ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0, 0]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0, 0], Editable -> False, Selectable -> 
                    False], ",", 
                   RowBox[{"Thickness", "\[Rule]", "0.005`"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.011111111111111112`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    "RGBColor[0.560181, 0.691569, 0.194885]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             GraphicsBox[{
               Thickness[0.1], 
               LineBox[{{1, 0}, {9, 0}}]}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"\"Column\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"Automatic", ",", "5"}], "}"}]}], "}"}]}]}], 
         "]"}]& )], Scaled[{0.33, 0.4}], ImageScaled[{0.5, 0.5}],
     BaseStyle->{FontSize -> Larger},
     FormatType->StandardForm]},
   AspectRatio->0.85,
   Axes->{True, True},
   AxesLabel->{
     FormBox["\"\[Theta]\"", TraditionalForm], 
     FormBox["\"|R|\"", TraditionalForm]},
   AxesOrigin->{0, 0},
   AxesStyle->{{
      Directive[
       GrayLevel[0]], Thickness -> 0.004}, {
      Directive[
       GrayLevel[0]], Thickness -> 0.004}},
   BaseStyle->{FontSize -> 18},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImageMargins->0.,
   ImagePadding->All,
   ImageSize->400,
   ImageSizeRaw->Automatic,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{0, 89.95437383553924}, {0, 0.9996432997330164}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}],
  InterpretTemplate[Legended[
    Graphics[{{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[0.011111111111111112`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6], FontSize -> 18], 
         Line[CompressedData["
1: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
          "]]}, {
         Hue[0.9060679774997897, 0.6, 0.6], 
         Directive[
          PointSize[0.011111111111111112`], 
          AbsoluteThickness[1.6], FontSize -> 18, 
          RGBColor[1, 0, 0], Thickness -> 0.005], 
         Line[CompressedData["
1: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
          "]]}, {
         Hue[0.1421359549995791, 0.6, 0.6], 
         Directive[
          PointSize[0.011111111111111112`], 
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6], FontSize -> 18], 
         Line[CompressedData["
1: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
aOxbjFYiD9wuyoxqfpWg/wFstail
          "]]}}}, {}, {}, {}, {}}, {
     DisplayFunction -> Identity, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
      PlotRange -> {{0, 89.95437383553924}, {0, 0.9996432997330164}}, 
      PlotRangeClipping -> True, ImagePadding -> All, DisplayFunction -> 
      Identity, AspectRatio -> 0.85, Axes -> {True, True}, 
      AxesLabel -> {"\[Theta]", "|R|"}, AxesOrigin -> {0, 0}, AxesStyle -> {{
         Directive[
          GrayLevel[0]], Thickness -> 0.004}, {
         Directive[
          GrayLevel[0]], Thickness -> 0.004}}, BaseStyle -> {FontSize -> 18}, 
      DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
      FrameLabel -> {{None, None}, {None, None}}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, GridLinesStyle -> Directive[
        GrayLevel[0.5, 0.4]], ImageSize -> 400, 
      Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}}, 
      PlotRange -> {{0, 89.95437383553924}, {0, 0.9996432997330164}}, 
      PlotRangeClipping -> True, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], {
     Placed[
      LineLegend[{
        Directive[
         PointSize[0.011111111111111112`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6], FontSize -> 18], 
        Directive[
         PointSize[0.011111111111111112`], 
         AbsoluteThickness[1.6], FontSize -> 18, 
         RGBColor[1, 0, 0], Thickness -> 0.005], 
        Directive[
         PointSize[0.011111111111111112`], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6], FontSize -> 18]}, {
       "d= 50nm", "d= 60nm", "d= 70nm"}, LegendMarkers -> Graphics[{
          Thickness[0.1], 
          Line[{{1, 0}, {9, 0}}]}], Joined -> {True, True, True}, 
       LabelStyle -> {}, LegendLayout -> {"Column", {Automatic, 5}}], {0.33, 
      0.4}, Identity]}]& ],
  AutoDelete->True,
  Editable->True,
  SelectWithContents->False,
  Selectable->True]], "Output",
 CellChangeTimes->{{3.789485661570839*^9, 3.7894857026590047`*^9}, 
   3.789490460272176*^9, 3.789490626124488*^9, 3.7894922344791393`*^9, {
   3.789493378478266*^9, 3.789493397934261*^9}, 3.789493496316671*^9, {
   3.7894939542151985`*^9, 3.7894939773083715`*^9}, 3.789494046985513*^9, {
   3.789494102960884*^9, 3.78949412749978*^9}, {3.7894941757950635`*^9, 
   3.7894942193885612`*^9}, {3.7894942752577953`*^9, 3.789494300203782*^9}, {
   3.789494343785286*^9, 3.7894943645296216`*^9}, {3.7894944074873943`*^9, 
   3.789494476028182*^9}, {3.7894945192857533`*^9, 3.7894946106714983`*^9}, 
   3.789494641311174*^9, {3.7894946780589423`*^9, 3.7894947338697543`*^9}, {
   3.7894952100024185`*^9, 3.789495225689416*^9}, 3.7894966217608733`*^9, 
   3.789496671262863*^9, {3.7894967831134872`*^9, 3.789496817082782*^9}, 
   3.7894968736868014`*^9, 3.7894971536460714`*^9, {3.7894971876442237`*^9, 
   3.78949720818149*^9}, 3.7894972528850346`*^9, 3.789497310077605*^9, {
   3.789497640070791*^9, 3.789497657774468*^9}, 3.789497733544923*^9, {
   3.789497888478367*^9, 3.7894979123854666`*^9}, 3.78949806093394*^9, {
   3.789498109069852*^9, 3.789498131860979*^9}, {3.789498300741731*^9, 
   3.7894983130916853`*^9}, 3.7894983611259*^9, 3.7894984095066047`*^9, {
   3.7894984559429083`*^9, 3.7894985155163946`*^9}, 3.789498555968235*^9, 
   3.7894985895551615`*^9, {3.789498625670617*^9, 3.7894986673850813`*^9}, {
   3.7894986980540543`*^9, 3.789498858591412*^9}, {3.7894988991899176`*^9, 
   3.789498902245719*^9}, {3.789498942001937*^9, 3.789498950229637*^9}, 
   3.789499596701157*^9, {3.7894996350287046`*^9, 3.7894996526037226`*^9}, {
   3.7895000384357023`*^9, 3.7895000627457457`*^9}, 3.789500132311825*^9, 
   3.7895002914609847`*^9, {3.789500325496027*^9, 3.789500362267736*^9}, 
   3.7895004333337975`*^9, {3.7895005001675797`*^9, 3.7895005060637856`*^9}, {
   3.7895005380233855`*^9, 3.7895005656605053`*^9}, 3.789500802577608*^9, {
   3.7895008453981743`*^9, 3.789500857513835*^9}, {3.7895008986818514`*^9, 
   3.7895009078446093`*^9}, 3.7895010774819093`*^9, 3.7895016395404253`*^9, {
   3.7895019537320833`*^9, 3.78950201770498*^9}, 3.7895020832362766`*^9, {
   3.78950231617844*^9, 3.7895023357515173`*^9}, 3.789502387176024*^9, {
   3.7895024394094653`*^9, 3.789502453943616*^9}, {3.7895024995418186`*^9, 
   3.789502506926545*^9}, {3.7895025430955763`*^9, 3.789502553252431*^9}, {
   3.789502612781268*^9, 3.7895026188660264`*^9}, {3.789565461706278*^9, 
   3.789565471601822*^9}, {3.789565600627389*^9, 3.789565644619857*^9}, {
   3.789565736548311*^9, 3.789565765595664*^9}, 3.7895657961974635`*^9, 
   3.7895662967128553`*^9, {3.7895663333199997`*^9, 3.7895663560473523`*^9}, 
   3.7895664415132723`*^9, {3.789566540108997*^9, 3.789566664063632*^9}, 
   3.7895667213973722`*^9, {3.789567074150135*^9, 3.789567080041386*^9}, 
   3.7895671581421647`*^9, 3.7895677459904685`*^9, {3.7895677924084177`*^9, 
   3.7895678237639694`*^9}, 3.789569348756955*^9, {3.78956940996273*^9, 
   3.789569426739853*^9}, 3.7895695181118393`*^9, {3.789569669413042*^9, 
   3.789569686463461*^9}, {3.789569750835905*^9, 3.7895698086962657`*^9}, {
   3.789570215094346*^9, 3.789570226506564*^9}, 3.7895702840148387`*^9, {
   3.7895703468719397`*^9, 3.7895703560773315`*^9}, {3.789570406656782*^9, 
   3.7895704576979604`*^9}, {3.789570507425726*^9, 3.789570561769458*^9}, 
   3.7895707450658913`*^9, {3.7895707823652325`*^9, 3.789570790503911*^9}, {
   3.78957095347773*^9, 3.789571029767851*^9}, {3.789571113956877*^9, 
   3.789571136234497*^9}, {3.7895720499308443`*^9, 3.789572082422961*^9}, {
   3.7895722027421513`*^9, 3.789572275832653*^9}, {3.78957232784861*^9, 
   3.7895723566616163`*^9}, 3.789572399383562*^9, {3.7895724502427006`*^9, 
   3.7895725211010585`*^9}, 3.789573976989421*^9, {3.7895852262507677`*^9, 
   3.7895852598529186`*^9}, 3.7895855404366837`*^9, {3.789585638481137*^9, 
   3.789585654437484*^9}, {3.7895856951400013`*^9, 3.789585728677352*^9}, {
   3.7895862861901584`*^9, 3.789586303152815*^9}, {3.7895863430144806`*^9, 
   3.789586367181878*^9}, {3.7895864019519343`*^9, 3.789586430996295*^9}, 
   3.789586534244443*^9, {3.7895867322351584`*^9, 3.7895867849557533`*^9}, {
   3.789586856829596*^9, 3.7895868737773237`*^9}, {3.789587030888381*^9, 
   3.789587044119977*^9}, 3.7895878817687864`*^9, 3.789587923434409*^9, 
   3.789587978887947*^9, 3.789588023578617*^9, {3.789588899378247*^9, 
   3.789588911358223*^9}, 3.789675034214444*^9, {3.7896761302261777`*^9, 
   3.789676189715643*^9}, {3.789676277689314*^9, 3.789676306358655*^9}, 
   3.7896766180390887`*^9, 3.7896766484658117`*^9, 3.7896769339118643`*^9, 
   3.78967757532196*^9, 3.789677711889618*^9, {3.789677759170389*^9, 
   3.7896777877683926`*^9}, {3.7896781494954033`*^9, 3.7896781754216166`*^9}, 
   3.78967843968987*^9, 3.7896784878714695`*^9, {3.789678519087965*^9, 
   3.7896785335573726`*^9}, 3.789678569068102*^9, 3.7896786207054796`*^9, 
   3.7896786542374554`*^9, {3.7896786905280085`*^9, 3.78967871853764*^9}, {
   3.789678766796077*^9, 3.7896787896044073`*^9}, 3.7896788289297647`*^9, {
   3.7896789111866193`*^9, 3.7896789625203705`*^9}, 3.789678993714959*^9, 
   3.789679662641593*^9, 3.78967975729535*^9, {3.789679941484553*^9, 
   3.7896799877815514`*^9}, 3.7896800394839354`*^9, {3.7896801125725837`*^9, 
   3.789680150707283*^9}, 3.7896802120111475`*^9, {3.7896802523626842`*^9, 
   3.7896802706544065`*^9}, 3.7896803172688923`*^9, 3.7896803924559393`*^9, 
   3.7896804244471617`*^9, 3.7896804625084934`*^9, {3.7896806678786516`*^9, 
   3.789680703387418*^9}, 3.7896807368096623`*^9, 3.7896812487475533`*^9, 
   3.789681324886734*^9, 3.789681453445594*^9, {3.7896815459029284`*^9, 
   3.789681578800742*^9}, 3.7896817456282473`*^9, {3.789681801830884*^9, 
   3.789681832521253*^9}, {3.7896818659347525`*^9, 3.7896818803876944`*^9}, {
   3.7896819278243275`*^9, 3.7896819499019184`*^9}, 3.7896819815402603`*^9, 
   3.78968201812333*^9, {3.789750092852991*^9, 3.7897501389929476`*^9}, 
   3.789750227304878*^9, {3.7897502647826967`*^9, 3.7897502864388065`*^9}, {
   3.789751990339861*^9, 3.7897520063211517`*^9}, 3.789753979174984*^9, {
   3.7897541155980263`*^9, 3.789754127656619*^9}, {3.7897568041413574`*^9, 
   3.78975689603029*^9}, {3.7897612278660183`*^9, 3.7897612574147897`*^9}, 
   3.789761296566815*^9, 3.7897620715694056`*^9, 3.789763794460105*^9, 
   3.789763846537882*^9, 3.7897638877043986`*^9, {3.7897640033002057`*^9, 
   3.7897640674255657`*^9}, 3.7897640975374513`*^9, 3.789764267510018*^9, 
   3.7897643435536184`*^9, {3.7897643760162435`*^9, 3.789764401381864*^9}, {
   3.7897645091628947`*^9, 3.7897645322915907`*^9}, 3.7897645697009788`*^9, {
   3.789766032522332*^9, 3.789766062569002*^9}, {3.7897661222881413`*^9, 
   3.7897661396000347`*^9}, {3.7897661856625495`*^9, 3.789766263694476*^9}, {
   3.7897663264281874`*^9, 
   3.7897663694497705`*^9}},ExpressionUUID->"ee5e7a36-3f08-4cb6-8cf4-\
10ea2780039a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tab3", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]", " ", 
         RowBox[{"180", "/", "\[Pi]"}]}], " ", ",", 
        RowBox[{"Refc", "[", 
         RowBox[{"70", "nm"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"1", "/", "100"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7897644530535264`*^9, 
  3.789764462007197*^9}},ExpressionUUID->"884fac5c-7c7a-455c-8094-\
38093cb277bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Tab3", ",", "Tab2"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<\[Theta]\>\"", ",", "\"\<Abs[R]\>\""}], "}"}]}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Noginov", "'"}], "s", " ", "Expression", " ", "vs", " ", "my", 
     " ", "expression", " ", "at", " ", "d"}], "=", 
    RowBox[{"70", "nm", " ", "Exact", " ", "match"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7896807717016563`*^9, 3.789680778759678*^9}, 
   3.7896808593727365`*^9, 3.7897500992748547`*^9, {3.789764411771927*^9, 
   3.7897644232880297`*^9}, {3.7897644664668665`*^9, 
   3.789764551647231*^9}},ExpressionUUID->"e5e22de1-b2b0-4613-8942-\
cbd358694520"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, {}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.01388888888888889], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1: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
+BarnsIFx4sS42pfRegfazaoiw==
      "]]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"\[Theta]\"", TraditionalForm], 
    FormBox["\"Abs[R]\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 89.95437383553924}, {0, 0.9996432997330155}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7897500997665095`*^9, 3.7897501390637574`*^9, 3.7897502273697033`*^9, {
   3.789750264868467*^9, 3.789750286509617*^9}, {3.7897519904116707`*^9, 
   3.7897520064109116`*^9}, 3.7897539792128825`*^9, {3.789756804202196*^9, 
   3.789756896100129*^9}, {3.789761227922899*^9, 3.7897612574616466`*^9}, 
   3.7897612966217375`*^9, 3.7897620716318893`*^9, 3.789763794507002*^9, 
   3.7897638465691266`*^9, 3.789763887751257*^9, {3.7897640033550587`*^9, 
   3.7897640312114716`*^9}, 3.789764067470417*^9, 3.789764097610797*^9, 
   3.789764267556899*^9, 3.7897643436004877`*^9, {3.7897643760711317`*^9, 
   3.7897644254125333`*^9}, {3.7897644673834496`*^9, 3.789764569794682*^9}, 
   3.7897660326316833`*^9, {3.789766326553193*^9, 
   3.7897663488901777`*^9}},ExpressionUUID->"d52af1b6-d35b-4913-be76-\
b74a3897d302"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"re", "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]d", "-", "\[Xi]m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Xi]v", "+", "\[Xi]m"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}], "d"}]]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]d", "+", "\[Xi]m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Xi]v", "-", "\[Xi]m"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}], "d"}]]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]d", "+", "\[Xi]m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Xi]v", "+", "\[Xi]m"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}], "d"}]]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]m", "-", "\[Xi]d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Xi]v", "-", "\[Xi]m"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"\[Kappa]", "[", "2", "]"}], "d"}]]}]}]]}], ";", "\n", 
   RowBox[{"\[Xi]d", "=", 
    FractionBox[
     RowBox[{"\[Kappa]", "[", "3", "]"}], 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]]}], ";", 
   RowBox[{"\[Xi]v", "=", 
    FractionBox[
     RowBox[{"\[Kappa]", "[", "1", "]"}], 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]]}], ";", 
   RowBox[{"\[Xi]m", "=", 
    FractionBox[
     RowBox[{"\[Kappa]", "[", "2", "]"}], 
     RowBox[{" ", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}]]}], ";", "\n", 
   RowBox[{"a2", "=", "re"}], ";"}], "*)"}]], "Input",ExpressionUUID->"1890b2df-24ea-4d28-9ae6-a8344ef33eae"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Nr", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zs", "-", "zm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"zm", "+", "zd"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", "\[ImaginaryI]", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}], "d", " "}]], 
      RowBox[{"(", 
       RowBox[{"zs", "+", "zm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"zm", "-", "zd"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"D1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zs", "+", "zm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"zm", "+", "zd"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", "\[ImaginaryI]", " ", 
        RowBox[{"\[Kappa]", "[", "2", "]"}], "d", " "}]], 
      RowBox[{"(", 
       RowBox[{"zs", "-", "zm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"zm", "-", "zd"}], ")"}]}]}]}], ";", "\n", 
   RowBox[{"zs", "=", " ", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "1", "]"}], "/", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}]}], ";", 
   RowBox[{"zm", "=", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "2", "]"}], "/", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}]}], ";", 
   RowBox[{"zd", "=", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "3", "]"}], "/", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}]}], ";", "\n", 
   RowBox[{"a2", "=", 
    RowBox[{"complexInner", "[", 
     RowBox[{"Nr", "/", "D1"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.789569967552769*^9},ExpressionUUID->"12664cbd-44ba-47ab-9cef-\
e9f0881acdb7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Kappa]", "[", "index_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["k0", "2"], 
      RowBox[{"\[Epsilon]", "[", "index", "]"}], 
      RowBox[{"\[Mu]", "[", "index", "]"}]}], "-", 
     SuperscriptBox["k", "2"]}], " ", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.789659284335472*^9, 3.7896592915721445`*^9}, 
   3.7896593796692443`*^9},ExpressionUUID->"a1a2b2d0-6f01-4428-82f0-\
885aece788fa"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Kappa]", "[", "index_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k0"}], " ", 
         FractionBox[
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "index", "]"}], 
           RowBox[{"\[Epsilon]", "[", "1", "]"}]}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Epsilon]", "[", "2", "]"}], "+", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]]}], ",", 
        RowBox[{"index", "\[Equal]", "4"}]}], "}"}], "}"}], ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "index", "]"}], 
        SuperscriptBox["k0", "2"]}], "-", 
       SuperscriptBox["k", "2"]}], "]"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7896593140342255`*^9, 3.789659320920427*^9}, 
   3.7896593825121527`*^9, {3.7896594342674685`*^9, 3.789659558815092*^9}, 
   3.7896596302376833`*^9, 
   3.7896744089574966`*^9},ExpressionUUID->"899c7cd9-d0da-46ea-acb9-\
7a524105ba5d"]
},
WindowSize->{1904, 981},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7bd4f23e-0010-4802-a23c-486271223f60"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 964, 14, 28, "Input",ExpressionUUID->"c634ed1a-5c65-414f-ad47-58390a39359b"],
Cell[1525, 36, 372, 8, 28, "Input",ExpressionUUID->"971af514-a3c5-4aa3-9920-53ece1d152e2"],
Cell[1900, 46, 1107, 35, 175, "Input",ExpressionUUID->"ff166fa1-dbce-45c2-a190-d0e3d516f3aa"],
Cell[CellGroupData[{
Cell[3032, 85, 3868, 106, 48, "Input",ExpressionUUID->"c655446d-0767-4591-9960-ff6a954f7afd"],
Cell[6903, 193, 7917, 125, 278, "Output",ExpressionUUID->"bde13c44-4960-4cdb-a7d9-c834f31705ee"]
}, Open  ]],
Cell[14835, 321, 154, 3, 28, "Input",ExpressionUUID->"338dd63c-8d50-411f-8b34-4fd577058cd4"],
Cell[CellGroupData[{
Cell[15014, 328, 6140, 142, 197, "Input",ExpressionUUID->"d3f9ea3a-b5d2-479e-8f12-bc3a61158db2"],
Cell[21157, 472, 7706, 106, 32, "Output",ExpressionUUID->"abb0f270-f1c8-4442-bd3b-0be9549442fd"]
}, Open  ]],
Cell[28878, 581, 1017, 21, 48, "Input",ExpressionUUID->"75ff96c5-180f-43a3-9879-a389e0d44cc2"],
Cell[29898, 604, 143, 3, 28, "Input",ExpressionUUID->"23f610d2-4a51-4403-8c30-6b53523b6709"],
Cell[30044, 609, 7940, 195, 219, "Input",ExpressionUUID->"123f0ae6-d7d5-4b5c-a632-8ad1ed7d2091"],
Cell[CellGroupData[{
Cell[38009, 808, 777, 18, 28, "Input",ExpressionUUID->"e1bd07e3-1bde-48ff-ab9b-46f16140e6aa"],
Cell[38789, 828, 7719, 129, 38, "Output",ExpressionUUID->"9d20f56d-8d0e-42ca-be6d-87bdee79a086"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46545, 962, 709, 16, 28, "Input",ExpressionUUID->"599aae47-3807-4290-b504-3da1d9f22c2d"],
Cell[47257, 980, 9586, 181, 54, "Output",ExpressionUUID->"421c4237-c4f4-4d37-87fc-149d09ffae14"]
}, Open  ]],
Cell[56858, 1164, 218, 5, 28, "Input",ExpressionUUID->"5d84c930-f1e6-4cbc-b1f8-520a322ef9c9"],
Cell[57079, 1171, 206, 6, 28, "Input",ExpressionUUID->"5bdcdf6a-7199-41e0-a62c-6506a5dff00e"],
Cell[CellGroupData[{
Cell[57310, 1181, 2796, 70, 83, "Input",ExpressionUUID->"3cd8c3b6-4f75-445d-b61e-fcf00960bed6"],
Cell[60109, 1253, 9528, 164, 56, "Output",ExpressionUUID->"451993ce-79a2-46ac-9986-ff08ae24219e"]
}, Open  ]],
Cell[69652, 1420, 279, 8, 28, "Input",ExpressionUUID->"c8c71353-082e-48c3-a6df-10b7b274d581"],
Cell[CellGroupData[{
Cell[69956, 1432, 1977, 39, 140, "Input",ExpressionUUID->"936aebc0-3235-4148-a713-dbf310be5b10"],
Cell[71936, 1473, 14753, 299, 108, "Output",ExpressionUUID->"f4162ff6-67c3-4046-85cf-e25efb3469af"]
}, Open  ]],
Cell[86704, 1775, 480, 8, 28, "Input",ExpressionUUID->"7f8e6a72-a216-41f6-ba1e-2d7d634b5d7f"],
Cell[87187, 1785, 207, 4, 28, "Input",ExpressionUUID->"7766d2b2-e38a-4000-8337-21eaff6ac279"],
Cell[CellGroupData[{
Cell[87419, 1793, 1953, 38, 83, "Input",ExpressionUUID->"5542f762-54ee-4e90-8621-2d724dd37bdb"],
Cell[89375, 1833, 3687, 87, 59, "Output",ExpressionUUID->"a8c91b3b-a95c-40b6-b648-dc690e1df893"]
}, Open  ]],
Cell[93077, 1923, 2305, 58, 172, "Input",ExpressionUUID->"b920a2e1-2f68-44a8-8be8-fb2539986ca2"],
Cell[95385, 1983, 929, 18, 28, "Input",ExpressionUUID->"5754e6e7-0091-4746-a172-358a2b93bea5"],
Cell[96317, 2003, 516, 14, 32, "Input",ExpressionUUID->"2ee1fa2e-d824-4699-b054-a57ad1a5731b"],
Cell[CellGroupData[{
Cell[96858, 2021, 426, 11, 48, "Input",ExpressionUUID->"7d8233d3-60bc-4e26-a193-1d27edd44de0"],
Cell[97287, 2034, 11404, 368, 152, "Output",ExpressionUUID->"df8713f9-4072-4d05-9234-2cad07a1c325"]
}, Open  ]],
Cell[108706, 2405, 4160, 75, 161, "Input",ExpressionUUID->"5eefb8e5-b6e8-4ea3-8c2b-5cea579bad6b",
 InitializationCell->True],
Cell[112869, 2482, 4136, 70, 64, "Input",ExpressionUUID->"25e06368-d8ab-46b4-bc97-7253060027ee",
 InitializationCell->True],
Cell[117008, 2554, 3510, 58, 64, "Input",ExpressionUUID->"29a72f81-b8d0-42f6-b3ff-6b0ff5491812",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[120543, 2616, 4230, 91, 67, "Input",ExpressionUUID->"fdb14cee-9857-4e99-84e1-74da7d6f28dd"],
Cell[124776, 2709, 44201, 824, 368, "Output",ExpressionUUID->"ee5e7a36-3f08-4cb6-8cf4-10ea2780039a"]
}, Open  ]],
Cell[168992, 3536, 640, 19, 48, "Input",ExpressionUUID->"884fac5c-7c7a-455c-8094-38093cb277bb"],
Cell[CellGroupData[{
Cell[169657, 3559, 849, 20, 28, "Input",ExpressionUUID->"e5e22de1-b2b0-4613-8942-cbd358694520"],
Cell[170509, 3581, 4905, 95, 232, "Output",ExpressionUUID->"d52af1b6-d35b-4913-be76-b74a3897d302"]
}, Open  ]],
Cell[175429, 3679, 1932, 54, 94, "Input",ExpressionUUID->"1890b2df-24ea-4d28-9ae6-a8344ef33eae"],
Cell[177364, 3735, 1665, 50, 90, "Input",ExpressionUUID->"12664cbd-44ba-47ab-9cef-e9f0881acdb7"],
Cell[179032, 3787, 498, 13, 32, "Input",ExpressionUUID->"a1a2b2d0-6f01-4428-82f0-885aece788fa"],
Cell[179533, 3802, 1117, 30, 40, "Input",ExpressionUUID->"899c7cd9-d0da-46ea-acb9-7a524105ba5d"]
}
]
*)

